import{v as t,j as e,e as M,i as O,a6 as C,bd as A,ax as Q,ah as D,au as U,bD as V,am as Z,w as K,aJ as J,T as _,bn as q}from"./vendor-react-tt7m-l12.js";import{C as a,a as H,I as X,M as Y}from"./index.dev-B-tTqmd2.js";import{c as z}from"./creatorService-B-Ontvi0.js";import"./vendor-mcp-DCT6vnr2.js";import"./vendor-misc-euQLCzIo.js";import"./vendor-network-aHtHbEbM.js";import"./vendor-terminal-D4sCRDlA.js";import"./vendor-ai-BVRLdj29.js";a.AWS,a.GCP,a.AZURE,a.AWS,a.GCP,a.AZURE;const ce=({onSaveFile:P,activeModelId:n,onCollapse:E,policies:ee,onWriteToTerminal:y})=>{const[m,I]=t.useState(a.AWS),[o,L]=t.useState(""),[i,b]=t.useState("prompt"),[r,w]=t.useState(null),[d,x]=t.useState([]),[h,N]=t.useState(!1),[g,S]=t.useState(!1),[c,p]=t.useState("design"),[l,f]=t.useState(null),G=t.useCallback(async()=>{if(o.trim()){N(!0),w(null),x([]),f(null),b("prompt");try{const s=await z.runSystemArchitect({systemDescription:o,scale:"default",constraints:m},n);w(s),b("review"),p("design")}catch(s){console.error("Error generating design:",s)}finally{N(!1)}}},[m,o,n]),R=t.useCallback(async()=>{if(r!=null&&r.diagram){S(!0),x([]),f(null);try{const s=await z.generateIaCFromDiagram(r.diagram,n),u=s.split("// FILE: ").filter(j=>j.trim());if(u.length>1){const j=u.map(v=>{const k=v.indexOf(`
`),B=v.substring(0,k).trim(),$=v.substring(k+1).trim();return{fileName:B,content:$}});x(j)}else x([{fileName:"main.tf",content:s}]);const W=await H.analyzeInfrastructure(s,n);f(W),b("code"),p("code")}catch(s){console.error("Error generating IaC",s)}finally{S(!1)}}},[r,n]),F=()=>{d.length!==0&&(d.forEach(s=>P(`infra/${s.fileName}`,s.content)),y(`
Sync complete: Files injected into workspace directory 'infra/'`))},T=[{id:"design",label:"Design",icon:O,available:i!=="prompt"},{id:"topology",label:"Topology",icon:C,available:i!=="prompt"},{id:"code",label:"IaC Code",icon:A,available:i==="code"},{id:"analysis",label:"Analysis",icon:Q,available:i==="code"}];return e.jsxs("div",{className:"h-full flex flex-col bg-[#0b0e14] text-[var(--color-text-primary)]",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-white/5 bg-[#0f111a]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"p-2 bg-purple-600/10 rounded-xl text-purple-400",children:[" ",e.jsx(M,{size:20})," "]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xs font-black uppercase tracking-[0.3em] text-white",children:"Infrastructure Studio"}),e.jsx("p",{className:"text-[9px] text-gray-600 font-bold uppercase",children:"Workspace Engine: Ready"})]})]}),e.jsx("button",{onClick:E,className:"text-gray-600 hover:text-white transition-colors",children:X.COLLAPSE_LEFT})]}),e.jsx("div",{className:"flex bg-white/[0.03] p-1 rounded-xl w-full",children:T.map(s=>e.jsxs("button",{onClick:()=>p(s.id),disabled:!s.available,className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c===s.id?"bg-white/5 text-white shadow-lg":"text-gray-600"} ${s.available?"hover:text-gray-400":"opacity-30 cursor-not-allowed"}`,children:[" ",e.jsx(s.icon,{size:12})," ",s.label," "]},s.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 space-y-6",children:[e.jsxs("section",{className:"bg-white/[0.02] border border-white/5 rounded-2xl p-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Cloud Target"}),e.jsxs("select",{value:m,onChange:s=>I(s.target.value),className:"w-full bg-[#131b2c] border border-white/5 rounded-xl px-3 py-2 text-xs text-white focus:outline-none focus:border-purple-500/50 appearance-none",children:[e.jsx("option",{value:a.AWS,children:"Amazon Web Services"}),e.jsx("option",{value:a.GCP,children:"Google Cloud"}),e.jsx("option",{value:a.AZURE,children:"Microsoft Azure"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Strategy"}),e.jsx("div",{className:"w-full bg-[#131b2c] border border-white/5 rounded-xl px-3 py-2 text-xs text-gray-500",children:"Modular (v1.4)"})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("textarea",{value:o,onChange:s=>L(s.target.value),placeholder:"Describe your infrastructure needs...",className:"w-full h-32 bg-[#131b2c] border border-white/5 rounded-2xl p-4 text-sm text-white resize-none focus:outline-none focus:border-purple-500/50 placeholder-gray-600 shadow-inner"}),e.jsx("div",{className:"absolute bottom-3 right-3",children:e.jsxs("button",{onClick:G,disabled:h||!o.trim(),className:"bg-purple-600 hover:bg-purple-500 text-white font-black py-2 px-6 rounded-xl text-[10px] uppercase tracking-widest transition-all shadow-lg shadow-purple-900/20 disabled:opacity-30 flex items-center gap-2",children:[h?e.jsx(D,{size:14,className:"animate-spin"}):e.jsx(U,{size:14,fill:"currentColor"}),h?"Designing...":"Design Architecture"]})})]})]}),i==="prompt"&&e.jsxs("div",{className:"py-20 text-center flex flex-col items-center opacity-30",children:[e.jsx(C,{size:48,strokeWidth:1,className:"mb-4"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Awaiting Design Prompt"}),e.jsx("p",{className:"text-[10px] max-w-[200px] mt-2 leading-relaxed",children:"Describe your desired system to begin the architectural synthesis process."})]}),i!=="prompt"&&e.jsxs("div",{className:"animate-fade-in",children:[c==="design"&&r&&e.jsx("div",{className:"bg-white/[0.02] border border-white/5 rounded-2xl p-5 prose prose-invert prose-sm max-w-none",children:e.jsx(Y,{content:r.description})}),c==="topology"&&r&&e.jsx("div",{className:"bg-[#0b0c10] rounded-2xl border border-white/5 p-4",children:e.jsx("pre",{className:"text-xs text-cyan-300 font-mono",children:e.jsx("code",{children:`graph TD
${r.diagram}`})})}),c==="code"&&d.length>0&&e.jsx("div",{className:"space-y-4",children:d.map((s,u)=>e.jsxs("div",{className:"rounded-2xl overflow-hidden border border-white/5 bg-[#0b0c10]",children:[e.jsxs("div",{className:"bg-white/5 px-4 py-2 border-b border-white/5 flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-mono text-cyan-400",children:s.fileName}),e.jsx("button",{className:"text-gray-600 hover:text-white",children:e.jsx(A,{size:12})})]}),e.jsx("pre",{className:"p-4 text-[10px] font-mono text-gray-400 overflow-x-auto custom-scrollbar max-h-60 leading-relaxed",children:e.jsx("code",{children:s.content})})]},u))}),c==="analysis"&&l&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-500/5 border border-green-500/10 p-4 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(V,{size:14,className:"text-green-400"}),e.jsx("span",{className:"text-[10px] font-black text-green-400 uppercase tracking-widest",children:"Monthly projection"})]}),e.jsx("p",{className:"text-2xl font-black text-white",children:l.costEstimate})]}),e.jsxs("div",{className:`p-4 rounded-2xl border ${l.securityStatus==="risk"?"bg-red-500/5 border-red-500/10":"bg-blue-500/5 border-blue-500/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.securityStatus==="risk"?e.jsx(Z,{size:14,className:"text-red-400"}):e.jsx(K,{size:14,className:"text-blue-400"}),e.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${l.securityStatus==="risk"?"text-red-400":"text-blue-400"}`,children:"Security status"})]}),e.jsx("p",{className:"text-lg font-bold text-white leading-none",children:l.securityStatus==="risk"?"Vulnerabilities detected":"Fully Compliant"})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-white/5 bg-[#0f111a] flex gap-3",children:[i==="review"&&e.jsxs("button",{onClick:R,disabled:g,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all shadow-lg shadow-emerald-900/20 flex items-center justify-center gap-2",children:[g?e.jsx(D,{size:14,className:"animate-spin"}):e.jsx(J,{size:14}),g?"Generating...":"Generate IaC Manifest"]}),i==="code"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{y("$ terraform plan"),p("analysis")},className:"flex-1 py-3 bg-white/[0.03] border border-white/5 hover:border-blue-500/30 hover:bg-blue-500/5 text-gray-400 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all flex items-center justify-center gap-2",children:[e.jsx(_,{size:14})," Run Plan"]}),e.jsxs("button",{onClick:F,className:"flex-1 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl text-[10px] font-black uppercase tracking-[0.2em] transition-all shadow-lg shadow-emerald-900/20 flex items-center justify-center gap-2",children:[e.jsx(q,{size:14})," Inject to Workspace"]})]})]})]})};export{ce as default};
