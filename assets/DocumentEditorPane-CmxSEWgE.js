import{v as l,i as T,m as re,b_ as Y,au as v,bn as Ks,aO as rt,ba as Lt,b$ as Rt,aC as ye,av as qe,c0 as Hs,c1 as qs,I as Qs,j as e,bZ as _s,ao as Ft,a3 as Ot,Z as Ys,X as I,y as Js,aQ as Qe,aY as _e,A as we,az as Xs,aq as L,aX as oe,ah as Ye,c2 as Zs,b2 as Bt,U as Je,R as Xe,c3 as ea,c4 as Gt,c5 as ta,z,bC as ke,c6 as Ze,c7 as et,c8 as Ut,c9 as sa,ca as aa,bq as Wt,b8 as ne,bv as ie,cb as tt,cc as st,cd as Vt,ce as la,bj as ra,bz as at,cf as Kt,cg as na,ch as ia,aI as oa,bK as Ht,ci as qt,P as Qt,W as ca,a$ as Zt,cj as da,E as xa,ck as _t,cl as Yt,bD as ma,cm as ha,bL as ua,cn as pa,bd as ba,co as ga,cp as fa,aF as Jt,cq as ja,M as va,ai as Na,aD as ya,aS as wa,cr as ka,cs as it,aV as nt,K as Sa}from"./vendor-react-tt7m-l12.js";import{a as Xt}from"./index.dev-B-tTqmd2.js";import"./vendor-mcp-DCT6vnr2.js";import"./vendor-misc-euQLCzIo.js";import"./vendor-network-aHtHbEbM.js";import"./vendor-terminal-D4sCRDlA.js";import"./vendor-ai-BVRLdj29.js";const B={nova:{bg:"bg-gradient-to-br from-[#c7d2fe] to-[#e0e7ff]",text:"text-[#0f172a]",accent:"text-[#4f46e5]",border:"border-[#4f46e5]/20",label:"Nova",category:"light"},twilight:{bg:"bg-gradient-to-br from-[#fde68a] to-[#fff7ed]",text:"text-[#0f172a]",accent:"text-[#d97706]",border:"border-[#d97706]/20",label:"Twilight",category:"light"},coral:{bg:"bg-gradient-to-br from-[#fecaca] to-[#fff1f2]",text:"text-[#0f172a]",accent:"text-[#dc2626]",border:"border-[#dc2626]/20",label:"Coral",category:"light"},mercury:{bg:"bg-gradient-to-br from-[#e5e7eb] to-[#f8fafc]",text:"text-[#0f172a]",accent:"text-[#475569]",border:"border-[#475569]/20",label:"Mercury",category:"light"},ashrose:{bg:"bg-gradient-to-br from-[#f3e8ff] to-[#faf5ff]",text:"text-[#0f172a]",accent:"text-[#7c3aed]",border:"border-[#7c3aed]/20",label:"Ashrose",category:"light"},spectrum:{bg:"bg-gradient-to-br from-[#dbeafe] to-[#fefce8]",text:"text-[#0f172a]",accent:"text-[#0891b2]",border:"border-[#0891b2]/20",label:"Spectrum",category:"light"},clean:{bg:"bg-white",text:"text-slate-900",accent:"text-blue-600",border:"border-gray-200",label:"Clean",category:"light"},mint:{bg:"bg-gradient-to-br from-[#d1fae5] to-[#ecfdf5]",text:"text-[#064e3b]",accent:"text-[#059669]",border:"border-[#059669]/20",label:"Mint",category:"light"},peach:{bg:"bg-gradient-to-br from-[#fed7aa] to-[#fff7ed]",text:"text-[#7c2d12]",accent:"text-[#ea580c]",border:"border-[#ea580c]/20",label:"Peach",category:"light"},lavender:{bg:"bg-gradient-to-br from-[#ddd6fe] to-[#f5f3ff]",text:"text-[#4c1d95]",accent:"text-[#7c3aed]",border:"border-[#7c3aed]/20",label:"Lavender",category:"light"},midnight:{bg:"bg-gradient-to-br from-slate-900 via-[#0f172a] to-black",text:"text-white",accent:"text-blue-400",border:"border-slate-800",label:"Midnight",category:"dark"},ocean:{bg:"bg-gradient-to-br from-cyan-600 to-blue-700",text:"text-white",accent:"text-cyan-200",border:"border-white/20",label:"Ocean",category:"dark"},noir:{bg:"bg-gradient-to-br from-[#18181b] to-[#09090b]",text:"text-white",accent:"text-zinc-400",border:"border-zinc-800",label:"Noir",category:"dark"},aurora:{bg:"bg-gradient-to-br from-[#4c1d95] via-[#7c3aed] to-[#2563eb]",text:"text-white",accent:"text-purple-200",border:"border-purple-500/30",label:"Aurora",category:"dark"},forest:{bg:"bg-gradient-to-br from-[#14532d] to-[#052e16]",text:"text-white",accent:"text-emerald-300",border:"border-emerald-600/30",label:"Forest",category:"dark"},sunset:{bg:"bg-gradient-to-br from-[#f97316] via-[#ec4899] to-[#8b5cf6]",text:"text-white",accent:"text-orange-200",border:"border-white/20",label:"Sunset",category:"dark"},ember:{bg:"bg-gradient-to-br from-[#991b1b] to-[#450a0a]",text:"text-white",accent:"text-red-300",border:"border-red-600/30",label:"Ember",category:"dark"},cosmic:{bg:"bg-gradient-to-br from-[#1e1b4b] via-[#312e81] to-[#0f172a]",text:"text-white",accent:"text-indigo-300",border:"border-indigo-500/30",label:"Cosmic",category:"dark"},slate:{bg:"bg-gradient-to-br from-[#334155] to-[#1e293b]",text:"text-white",accent:"text-slate-300",border:"border-slate-600",label:"Slate",category:"dark"},royal:{bg:"bg-gradient-to-br from-[#1e3a8a] to-[#172554]",text:"text-white",accent:"text-blue-300",border:"border-blue-600/30",label:"Royal",category:"dark"}},Se=[{id:"t1",name:"Startup Pitch Deck",category:"Business",theme:"midnight",meta:"12 slides Â· Investor-ready",icon:"ðŸš€",featured:!0},{id:"t2",name:"Quarterly Business Review",category:"Business",theme:"nova",meta:"Data-focused layout",icon:"ðŸ“Š"},{id:"t3",name:"Company All-Hands",category:"Business",theme:"spectrum",meta:"Clear communication",icon:"ðŸ‘¥"},{id:"t4",name:"Board Meeting",category:"Business",theme:"slate",meta:"Executive summary",icon:"ðŸŽ¯"},{id:"t5",name:"Business Proposal",category:"Business",theme:"royal",meta:"Win clients",icon:"ðŸ“‹"},{id:"t6",name:"Product Launch",category:"Marketing",theme:"coral",meta:"Bold visuals",icon:"ðŸŽ‰",featured:!0},{id:"t7",name:"Marketing Strategy",category:"Marketing",theme:"ashrose",meta:"Growth planning",icon:"ðŸ“ˆ"},{id:"t8",name:"Brand Partnership",category:"Marketing",theme:"sunset",meta:"Collaboration pitch",icon:"ðŸ¤"},{id:"t9",name:"Social Media Campaign",category:"Marketing",theme:"aurora",meta:"Viral content",icon:"ðŸ“±"},{id:"t10",name:"Content Calendar",category:"Marketing",theme:"peach",meta:"Monthly planning",icon:"ðŸ“…"},{id:"t11",name:"Sales Deck",category:"Sales",theme:"ocean",meta:"Close deals faster",icon:"ðŸ’°",featured:!0},{id:"t12",name:"Customer Case Study",category:"Sales",theme:"mint",meta:"Success stories",icon:"â­"},{id:"t13",name:"Pricing Presentation",category:"Sales",theme:"clean",meta:"Value proposition",icon:"ðŸ’Ž"},{id:"t14",name:"Demo Walkthrough",category:"Sales",theme:"cosmic",meta:"Product showcase",icon:"ðŸ–¥ï¸"},{id:"t15",name:"Product Roadmap",category:"Product",theme:"lavender",meta:"Vision & timeline",icon:"ðŸ—ºï¸",featured:!0},{id:"t16",name:"User Research",category:"Product",theme:"spectrum",meta:"Insights & findings",icon:"ðŸ”¬"},{id:"t17",name:"Feature Announcement",category:"Product",theme:"forest",meta:"Release notes",icon:"âœ¨"},{id:"t18",name:"Design Review",category:"Product",theme:"mercury",meta:"Visual feedback",icon:"ðŸŽ¨"},{id:"t19",name:"Sprint Retrospective",category:"Product",theme:"twilight",meta:"Team learnings",icon:"ðŸ”„"},{id:"t20",name:"Course Overview",category:"Education",theme:"nova",meta:"Engaging lessons",icon:"ðŸ“š",featured:!0},{id:"t21",name:"Training Workshop",category:"Education",theme:"mint",meta:"Interactive learning",icon:"ðŸŽ“"},{id:"t22",name:"Research Presentation",category:"Education",theme:"clean",meta:"Academic style",icon:"ðŸ”Ž"},{id:"t23",name:"Onboarding Guide",category:"Education",theme:"peach",meta:"New user welcome",icon:"ðŸ‘‹"},{id:"t24",name:"Tutorial Deck",category:"Education",theme:"lavender",meta:"Step-by-step",icon:"ðŸ“"},{id:"t25",name:"Portfolio Showcase",category:"Creative",theme:"noir",meta:"Visual impact",icon:"ðŸŽ­",featured:!0},{id:"t26",name:"Event Microsite",category:"Creative",theme:"aurora",meta:"Stunning landing",icon:"ðŸŽª"},{id:"t27",name:"Photo Gallery",category:"Creative",theme:"midnight",meta:"Image-first",icon:"ðŸ“¸"},{id:"t28",name:"Webinar Template",category:"Creative",theme:"ember",meta:"Live presentation",icon:"ðŸŽ™ï¸"},{id:"t29",name:"Newsletter Design",category:"Creative",theme:"coral",meta:"Email-ready",icon:"ðŸ’Œ"},{id:"t30",name:"Infographic Deck",category:"Creative",theme:"sunset",meta:"Data storytelling",icon:"ðŸ“‰"}],Ca=[{id:"title",name:"Title Slide",icon:"ðŸŽ¬",description:"Big title with subtitle"},{id:"content",name:"Content",icon:"ðŸ“",description:"Title with bullet points"},{id:"visual",name:"Visual",icon:"ðŸ–¼ï¸",description:"Split text and image"},{id:"big-number",name:"Big Number",icon:"ðŸ“Š",description:"Highlight key metrics"},{id:"two-column",name:"Two Column",icon:"ðŸ“°",description:"Side by side content"},{id:"comparison",name:"Comparison",icon:"âš–ï¸",description:"Before vs after"},{id:"timeline",name:"Timeline",icon:"ðŸ“…",description:"Show progression"},{id:"quote",name:"Quote",icon:"ðŸ’¬",description:"Testimonial or quote"},{id:"gallery",name:"Gallery",icon:"ðŸŽ¨",description:"Multiple images"},{id:"team",name:"Team",icon:"ðŸ‘¥",description:"Introduce team members"}],es=[{id:"d1",name:"Blank Document",category:"Basic",icon:"ðŸ“„",description:"Start fresh"},{id:"d2",name:"Project Proposal",category:"Business",icon:"ðŸ“‹",description:"Formal proposal template"},{id:"d3",name:"Meeting Notes",category:"Business",icon:"ðŸ“",description:"Structured meeting notes"},{id:"d4",name:"Technical Spec",category:"Engineering",icon:"âš™ï¸",description:"Technical documentation"},{id:"d5",name:"API Documentation",category:"Engineering",icon:"ðŸ”Œ",description:"REST API docs"},{id:"d6",name:"Blog Post",category:"Content",icon:"âœï¸",description:"SEO-optimized blog"},{id:"d7",name:"Press Release",category:"Content",icon:"ðŸ“°",description:"News announcement"},{id:"d8",name:"Business Plan",category:"Business",icon:"ðŸŽ¯",description:"Comprehensive plan"},{id:"d9",name:"User Guide",category:"Documentation",icon:"ðŸ“š",description:"Product manual"},{id:"d10",name:"Research Report",category:"Academic",icon:"ðŸ”¬",description:"Academic research"},{id:"d11",name:"Resume/CV",category:"Personal",icon:"ðŸ‘¤",description:"Professional resume"},{id:"d12",name:"Cover Letter",category:"Personal",icon:"ðŸ’Œ",description:"Job application"}],ts=[{id:"s1",name:"Blank Spreadsheet",category:"Basic",icon:"ðŸ“Š",description:"Empty grid"},{id:"s2",name:"Budget Tracker",category:"Finance",icon:"ðŸ’°",description:"Monthly budget"},{id:"s3",name:"Project Timeline",category:"Project",icon:"ðŸ“…",description:"Gantt-style tracker"},{id:"s4",name:"Invoice Template",category:"Finance",icon:"ðŸ§¾",description:"Client invoicing"},{id:"s5",name:"Employee Directory",category:"HR",icon:"ðŸ‘¥",description:"Team contacts"},{id:"s6",name:"Inventory Tracker",category:"Operations",icon:"ðŸ“¦",description:"Stock management"},{id:"s7",name:"Sales Pipeline",category:"Sales",icon:"ðŸ“ˆ",description:"Deal tracking"},{id:"s8",name:"OKR Tracker",category:"Project",icon:"ðŸŽ¯",description:"Goals & key results"},{id:"s9",name:"Expense Report",category:"Finance",icon:"ðŸ’³",description:"Business expenses"},{id:"s10",name:"KPI Dashboard",category:"Analytics",icon:"ðŸ“‰",description:"Metrics overview"},{id:"s11",name:"Customer List",category:"CRM",icon:"ðŸ¤",description:"Contact management"},{id:"s12",name:"Sprint Backlog",category:"Agile",icon:"ðŸƒ",description:"Sprint planning"}],za=[{name:"SUM",syntax:"=SUM(A1:A10)",description:"Add numbers"},{name:"AVERAGE",syntax:"=AVERAGE(A1:A10)",description:"Calculate mean"},{name:"COUNT",syntax:"=COUNT(A1:A10)",description:"Count numbers"},{name:"MAX",syntax:"=MAX(A1:A10)",description:"Find maximum"},{name:"MIN",syntax:"=MIN(A1:A10)",description:"Find minimum"},{name:"IF",syntax:'=IF(A1>10,"Yes","No")',description:"Conditional logic"},{name:"VLOOKUP",syntax:"=VLOOKUP(A1,B:C,2,FALSE)",description:"Lookup value"},{name:"CONCAT",syntax:"=CONCAT(A1,B1)",description:"Join text"}],lt=D=>{let k="",h=D;for(;h>=0;)k=String.fromCharCode(h%26+65)+k,h=Math.floor(h/26)-1;return k},Aa=({onBack:D,onSelect:k})=>{const[h,g]=l.useState(""),[x,u]=l.useState("templates"),S=["All","Business","Academic","Technical","Creative","Personal"],[N,C]=l.useState("All"),b=es.filter(c=>{const p=c.name.toLowerCase().includes(h.toLowerCase())||c.description.toLowerCase().includes(h.toLowerCase()),y=N==="All"||c.category===N;return p&&y});return e.jsxs("div",{className:"flex h-full w-full bg-[#faf8f5]",children:[e.jsxs("div",{className:"w-64 border-r border-slate-200 bg-white flex flex-col shrink-0",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 text-sm mb-4 transition-colors",children:[e.jsx(oe,{size:16})," Back to dashboard"]}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"New Document"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Choose a template to get started"})]}),e.jsx("div",{className:"p-4 border-b border-slate-100",children:e.jsxs("div",{className:"flex gap-1 p-1 bg-slate-100 rounded-xl",children:[e.jsxs("button",{onClick:()=>u("templates"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${x==="templates"?"bg-blue-600 text-white shadow-lg":"text-slate-500 hover:text-slate-800"}`,children:[e.jsx(it,{size:14,className:"inline mr-2"})," Templates"]}),e.jsxs("button",{onClick:()=>u("ai"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${x==="ai"?"bg-purple-600 text-white shadow-lg":"text-slate-500 hover:text-slate-800"}`,children:[e.jsx(v,{size:14,className:"inline mr-2"})," AI Generate"]})]})}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto custom-scrollbar",children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Categories"}),e.jsx("div",{className:"space-y-1",children:S.map(c=>e.jsx("button",{onClick:()=>C(c),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all ${N===c?"bg-blue-100 text-blue-700":"text-slate-600 hover:bg-slate-100 hover:text-slate-800"}`,children:c},c))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col bg-[#faf8f5]",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("input",{type:"text",value:h,onChange:c=>g(c.target.value),placeholder:"Search templates...",className:"w-full max-w-md px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-sm text-slate-800 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20"})}),x==="templates"?e.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:b.map(c=>e.jsxs("button",{onClick:()=>k(c.id),className:"group bg-white border border-slate-200 rounded-xl p-4 text-left hover:border-blue-400 hover:shadow-lg hover:shadow-blue-500/10 transition-all",children:[e.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg mb-3 flex items-center justify-center text-3xl group-hover:scale-105 transition-transform",children:c.icon}),e.jsx("h3",{className:"font-semibold text-slate-800 text-sm mb-1",children:c.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:c.description})]},c.id))})}):e.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl shadow-purple-500/20",children:e.jsx(v,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Generate with AI"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"Describe your document and let AI create the structure for you"}),e.jsx("textarea",{className:"w-full h-32 bg-white border border-slate-200 rounded-xl p-4 text-slate-800 placeholder-slate-400 resize-none focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 mb-4",placeholder:"E.g., Create a project proposal for a mobile app development project..."}),e.jsxs("button",{className:"w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white font-semibold rounded-xl transition-all shadow-lg shadow-purple-500/20 flex items-center justify-center gap-2",children:[e.jsx(v,{size:16})," Generate Document"]})]})})]})]})},$a=({onBack:D,onSelect:k})=>{const[h,g]=l.useState(""),[x,u]=l.useState("templates"),S=["All","Finance","Project Management","HR","Sales","Analytics"],[N,C]=l.useState("All"),b=ts.filter(c=>{const p=c.name.toLowerCase().includes(h.toLowerCase())||c.description.toLowerCase().includes(h.toLowerCase()),y=N==="All"||c.category===N;return p&&y});return e.jsxs("div",{className:"flex h-full w-full bg-[#faf8f5]",children:[e.jsxs("div",{className:"w-64 border-r border-slate-200 bg-white flex flex-col shrink-0",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 text-sm mb-4 transition-colors",children:[e.jsx(oe,{size:16})," Back to dashboard"]}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"New Spreadsheet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Choose a template to get started"})]}),e.jsx("div",{className:"p-4 border-b border-slate-100",children:e.jsxs("div",{className:"flex gap-1 p-1 bg-slate-100 rounded-xl",children:[e.jsxs("button",{onClick:()=>u("templates"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${x==="templates"?"bg-emerald-600 text-white shadow-lg":"text-slate-500 hover:text-slate-800"}`,children:[e.jsx(it,{size:14,className:"inline mr-2"})," Templates"]}),e.jsxs("button",{onClick:()=>u("ai"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${x==="ai"?"bg-purple-600 text-white shadow-lg":"text-slate-500 hover:text-slate-800"}`,children:[e.jsx(v,{size:14,className:"inline mr-2"})," AI Generate"]})]})}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto custom-scrollbar",children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Categories"}),e.jsx("div",{className:"space-y-1",children:S.map(c=>e.jsx("button",{onClick:()=>C(c),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all ${N===c?"bg-emerald-100 text-emerald-700":"text-slate-600 hover:bg-slate-100 hover:text-slate-800"}`,children:c},c))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col bg-[#faf8f5]",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("input",{type:"text",value:h,onChange:c=>g(c.target.value),placeholder:"Search templates...",className:"w-full max-w-md px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-sm text-slate-800 placeholder-slate-400 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"})}),x==="templates"?e.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:b.map(c=>e.jsxs("button",{onClick:()=>k(c.id),className:"group bg-white border border-slate-200 rounded-xl p-4 text-left hover:border-emerald-400 hover:shadow-lg hover:shadow-emerald-500/10 transition-all",children:[e.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg mb-3 flex items-center justify-center text-3xl group-hover:scale-105 transition-transform",children:c.icon}),e.jsx("h3",{className:"font-semibold text-slate-800 text-sm mb-1",children:c.name}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:c.description})]},c.id))})}):e.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-2xl shadow-emerald-500/20",children:e.jsx(v,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Generate with AI"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"Describe your data and let AI create the spreadsheet structure"}),e.jsx("textarea",{className:"w-full h-32 bg-white border border-slate-200 rounded-xl p-4 text-slate-800 placeholder-slate-400 resize-none focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 mb-4",placeholder:"E.g., Create a monthly budget tracker with income, expenses, and savings..."}),e.jsxs("button",{className:"w-full py-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white font-semibold rounded-xl transition-all shadow-lg shadow-emerald-500/20 flex items-center justify-center gap-2",children:[e.jsx(v,{size:16})," Generate Spreadsheet"]})]})})]})]})},Da=({onBack:D,onSelect:k})=>{const[h,g]=l.useState("All"),[x,u]=l.useState("templates"),[S,N]=l.useState(""),[C,b]=l.useState("all"),c=["All","Business","Marketing","Sales","Product","Education","Creative"],p=Se.filter(o=>{const f=h==="All"||o.category===h,J=!S||o.name.toLowerCase().includes(S.toLowerCase());return f&&J}),y=Se.filter(o=>o.featured);return e.jsxs("div",{className:"flex h-full w-full bg-[#faf8f5] text-slate-800 font-sans absolute inset-0 z-50 overflow-hidden",children:[e.jsxs("div",{className:"w-72 border-r border-slate-200 bg-white p-6 flex flex-col",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-orange-500 to-pink-600 rounded-xl text-white shadow-lg shadow-orange-500/20",children:e.jsx(Y,{size:22})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-lg tracking-tight text-slate-800",children:"Slides"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Gamma-style presentations"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>u("templates"),className:`flex items-center gap-3 w-full px-4 py-3 rounded-xl font-semibold text-sm transition-all ${x==="templates"?"bg-slate-100 text-slate-800":"text-slate-500 hover:text-slate-800 hover:bg-slate-50"}`,children:[e.jsx(it,{size:18})," Templates"]}),e.jsxs("button",{onClick:()=>u("ai"),className:`flex items-center gap-3 w-full px-4 py-3 rounded-xl font-semibold text-sm transition-all ${x==="ai"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg":"text-slate-500 hover:text-slate-800 hover:bg-slate-50"}`,children:[e.jsx(v,{size:18})," Generate with AI"]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3 px-2",children:"Categories"}),e.jsx("div",{className:"space-y-0.5",children:c.map(o=>e.jsxs("button",{onClick:()=>{g(o),u("templates")},className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-all ${h===o&&x==="templates"?"bg-orange-100 text-orange-700 font-semibold":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"}`,children:[o,e.jsx("span",{className:"text-[10px] text-slate-400 ml-2",children:o==="All"?Se.length:Se.filter(f=>f.category===o).length})]},o))})]}),e.jsx("div",{className:"mt-auto pt-6 border-t border-slate-200",children:e.jsxs("button",{onClick:D,className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 text-sm font-medium transition-colors w-full px-2 py-2 rounded-lg hover:bg-slate-50",children:[e.jsx(oe,{size:16})," Back to Dashboard"]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-[#faf8f5]",children:x==="templates"?e.jsxs("div",{className:"max-w-[1400px] mx-auto px-12 py-12",children:[e.jsx("div",{className:"mb-10",children:e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-[11px] font-bold tracking-[2px] uppercase text-purple-600 mb-2 flex items-center gap-2",children:[e.jsx(v,{size:12})," Create New"]}),e.jsx("h1",{className:"text-4xl font-bold text-slate-800 leading-tight tracking-tight",children:"Choose a Template"}),e.jsx("p",{className:"text-slate-500 mt-2 text-sm max-w-xl",children:"Start with a professionally designed template. Each is optimized for clarity, storytelling, and modern presentations."})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",placeholder:"Search templates...",value:S,onChange:o=>N(o.target.value),className:"w-64 bg-white border border-slate-200 rounded-xl px-4 py-2.5 text-sm text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})})})]})}),h==="All"&&!S&&e.jsxs("div",{className:"mb-12",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-500",children:"â­"})," Featured Templates"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:y.slice(0,3).map(o=>{const f=B[o.theme];return f?e.jsxs("button",{onClick:()=>k("content",o.theme),className:"relative h-[200px] rounded-2xl p-6 flex flex-col justify-between overflow-hidden cursor-pointer transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl shadow-lg group text-left border border-white/10",children:[e.jsx("div",{className:`absolute inset-0 ${f.bg}`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),e.jsx("div",{className:"relative z-10 text-3xl",children:o.icon}),e.jsx("div",{className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/20 backdrop-blur-sm text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-20",children:e.jsx(nt,{size:16,strokeWidth:3})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"text-[10px] font-bold tracking-widest text-white/60 uppercase mb-1",children:o.category}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:o.name}),e.jsx("div",{className:"text-xs text-white/70",children:o.meta})]})]},o.id):null})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4",children:[h==="All"?"All Templates":h,e.jsxs("span",{className:"text-slate-400 font-normal ml-2",children:["(",p.length,")"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 pb-20",children:[e.jsxs("button",{onClick:()=>k("fluid","clean"),className:"h-[180px] rounded-2xl p-5 flex flex-col justify-center items-center relative overflow-hidden cursor-pointer bg-white border-2 border-dashed border-slate-300 hover:border-purple-500 hover:bg-purple-50 transition-all group",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform text-slate-400 group-hover:text-purple-500",children:e.jsx(L,{size:28})}),e.jsx("h4",{className:"text-base font-bold text-slate-600 group-hover:text-purple-600",children:"Start Blank"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Empty canvas"})]}),p.map(o=>{const f=B[o.theme];return f?e.jsxs("button",{onClick:()=>k("content",o.theme),className:"relative h-[180px] rounded-2xl p-5 flex flex-col justify-between overflow-hidden cursor-pointer transition-all duration-300 hover:-translate-y-1 hover:shadow-xl group text-left border border-white/10 hover:border-white/20",children:[e.jsx("div",{className:`absolute inset-0 ${f.bg} opacity-80`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent"}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl",children:o.icon}),e.jsx("div",{className:"w-7 h-7 rounded-full bg-white/20 backdrop-blur-sm text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(nt,{size:14,strokeWidth:3})})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"text-[9px] font-bold tracking-widest text-white/50 uppercase mb-0.5",children:o.category}),e.jsx("h3",{className:"text-sm font-bold text-white leading-tight",children:o.name}),e.jsx("div",{className:"text-[10px] text-white/60 mt-0.5",children:o.meta})]})]},o.id):null})]})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-full p-8",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full border border-purple-200 mb-4",children:[e.jsx(v,{size:14,className:"text-purple-600"}),e.jsx("span",{className:"text-xs font-bold text-purple-700 uppercase tracking-wider",children:"AI-Powered"})]}),e.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"Generate a Presentation"}),e.jsx("p",{className:"text-slate-500 max-w-lg mx-auto",children:"Describe your idea, paste an outline, or import content. Our AI will create a stunning deck in seconds."})]}),e.jsxs("div",{className:"bg-white rounded-3xl border border-slate-200 p-8 shadow-xl",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-800 rounded-lg text-sm font-semibold",children:[e.jsx(Zt,{size:14})," Text Prompt"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 text-slate-500 hover:text-slate-800 hover:bg-slate-50 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(T,{size:14})," Paste Outline"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 text-slate-500 hover:text-slate-800 hover:bg-slate-50 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(rt,{size:14})," Import File"]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("textarea",{placeholder:"Describe your presentation... e.g., 'Q4 strategy deck for fintech startup focusing on growth metrics and 2025 roadmap'",className:"w-full bg-black/30 border border-white/10 rounded-2xl p-5 text-white placeholder-gray-500 resize-none h-32 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"}),e.jsx("div",{className:"absolute bottom-4 right-4 flex items-center gap-2",children:e.jsx("span",{className:"text-[10px] text-gray-500",children:"Press âŒ˜ Enter to generate"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Slide Count"}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-800 appearance-none focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{children:"6 slides"}),e.jsx("option",{children:"8 slides"}),e.jsx("option",{children:"10 slides"}),e.jsx("option",{children:"12 slides"}),e.jsx("option",{children:"15 slides"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Text Density"}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-800 appearance-none focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{children:"Minimal"}),e.jsx("option",{children:"Standard"}),e.jsx("option",{children:"Detailed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Language"}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-800 appearance-none focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Spanish"}),e.jsx("option",{children:"French"}),e.jsx("option",{children:"German"}),e.jsx("option",{children:"Portuguese"}),e.jsx("option",{children:"Japanese"}),e.jsx("option",{children:"Chinese"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Theme"}),e.jsx("div",{className:"flex gap-2",children:["all","light","dark"].map(o=>e.jsx("button",{onClick:()=>b(o),className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase transition-all ${C===o?"bg-slate-100 text-slate-800":"text-slate-500 hover:text-slate-800"}`,children:o},o))})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Object.entries(B).filter(([o,f])=>C==="all"||f.category===C).slice(0,10).map(([o,f])=>e.jsxs("button",{className:"relative h-16 rounded-xl overflow-hidden border-2 transition-all group border-transparent hover:border-purple-500",children:[e.jsx("div",{className:`absolute inset-0 ${f.bg}`}),e.jsx("span",{className:`absolute bottom-1 left-2 text-[9px] font-bold ${f.text} drop-shadow-md opacity-80`,children:f.label})]},o))})]}),e.jsxs("button",{onClick:()=>k("content","midnight"),className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white text-base font-bold py-4 rounded-xl shadow-lg shadow-purple-500/25 transition-all hover:shadow-purple-500/40 flex items-center justify-center gap-3",children:[e.jsx(v,{size:18,fill:"currentColor"}),"Generate Presentation"]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3 text-center",children:"Try these prompts"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:["Startup pitch deck for AI company","Q4 marketing strategy presentation","Product roadmap for 2025","Team onboarding guide","Sales deck for enterprise clients"].map(o=>e.jsx("button",{className:"px-4 py-2 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-full text-xs text-slate-600 hover:text-slate-800 transition-all",children:o},o))})]})]})})})]})},_a=({onCollapse:D,activeModelId:k,currentUser:h})=>{var Et,Mt;const[g,x]=l.useState("dashboard"),[u,S]=l.useState("docs"),[N,C]=l.useState("Untitled document"),[b,c]=l.useState(""),[p,y]=l.useState({bold:!1,italic:!1,underline:!1,align:"left",list:null}),[o,f]=l.useState(11),J=50,ce=26,[G,Ce]=l.useState(()=>Array.from({length:J},()=>Array(ce).fill(""))),[d,ze]=l.useState(null),[Ae,$e]=l.useState({}),[De,Te]=l.useState(null),[Pe,ss]=l.useState([{id:"1",title:"Main Section"}]),[as,ot]=l.useState("1"),Ee=l.useRef(null),ls=l.useRef(null),[V,Me]=l.useState("Editing"),[de,X]=l.useState(!1),[w,U]=l.useState([{id:"1",layout:"title",title:"Q3 Product Strategy",subtitle:"Accelerating Growth with AI",body:""},{id:"2",layout:"content",title:"Key Objectives",subtitle:"",body:`â€¢ Scale infrastructure to 99.99% uptime
â€¢ Integrate Gemini 3 Pro across all surfaces
â€¢ Launch Creator Studio Beta`},{id:"3",layout:"big-number",title:"User Growth",subtitle:"Month over Month",body:"142%"},{id:"4",layout:"visual",title:"Architecture Overview",subtitle:"System Design",body:""}]),[$,P]=l.useState(0),[K,xe]=l.useState("midnight"),[me,ct]=l.useState(!1),[rs,E]=l.useState(!1),[H,he]=l.useState(""),[dt,ns]=l.useState(8),[is,os]=l.useState("standard"),[Ie,xt]=l.useState(!1),[mt,Le]=l.useState(!1),[ht,cs]=l.useState(260),[Z,ut]=l.useState(!1),Re=l.useRef(null),[ue,ds]=l.useState(()=>{const t=localStorage.getItem("sai-recent-docs");return t?JSON.parse(t):[]}),[xs,Fe]=l.useState(null),[pt,bt]=l.useState(!1),[Ta,ms]=l.useState(null),[M,Oe]=l.useState(!1),[Be,hs]=l.useState(!1),[gt,Pa]=l.useState([]),[ee,us]=l.useState(500),[Ea,ps]=l.useState(null),[Ge,bs]=l.useState(!1),[Ma,Ia]=l.useState(null),[Ue,gs]=l.useState([{id:"1",name:"Sheet 1"}]),[fs,ft]=l.useState("1"),[te,jt]=l.useState("none"),[js,q]=l.useState(!1),[vs,Q]=l.useState(!1),[W,pe]=l.useState("synced"),[Ns,be]=l.useState(!1),[R,We]=l.useState([]),[ys,se]=l.useState(!1),[ge,ws]=l.useState("private"),[F,vt]=l.useState(""),[Nt,ks]=l.useState("edit"),[yt,wt]=l.useState(""),[kt,O]=l.useState([]),[La,Ra]=l.useState(!1),[St,Ss]=l.useState(!1),[Cs,zs]=l.useState(!1),[Fa,Oa]=l.useState("en"),[Ct,Ba]=l.useState(!0),zt=l.useRef(null),As=[{id:"new-doc",label:"New Document",icon:T,shortcut:"D",action:()=>A("docs")},{id:"new-sheet",label:"New Spreadsheet",icon:re,shortcut:"S",action:()=>A("sheets")},{id:"new-slide",label:"New Presentation",icon:Y,shortcut:"P",action:()=>A("slides")},{id:"ai-generate",label:"Generate with AI",icon:v,shortcut:"âŒ˜K",action:()=>{S("slides"),x("slide-setup"),E(!0)}},{id:"save",label:"Save Document",icon:Ks,shortcut:"âŒ˜S",action:()=>$s()},{id:"export",label:"Export",icon:rt,shortcut:"âŒ˜E",action:()=>Le(!0)},{id:"share",label:"Share Document",icon:Lt,shortcut:"âŒ˜â‡§S",action:()=>se(!0)},{id:"focus",label:"Toggle Focus Mode",icon:Rt,shortcut:"âŒ˜â‡§F",action:()=>Oe(!M)},{id:"shortcuts",label:"Keyboard Shortcuts",icon:ye,shortcut:"âŒ˜/",action:()=>Q(!0)},{id:"history",label:"Version History",icon:qe,shortcut:"âŒ˜H",action:()=>be(!0)},{id:"dark-mode",label:"Toggle Dark Mode",icon:St?Hs:qs,shortcut:"âŒ˜D",action:()=>Ss(!St)},{id:"voice",label:"Voice Input",icon:Qs,shortcut:"âŒ˜M",action:()=>zs(!Cs)}].filter(t=>t.label.toLowerCase().includes(yt.toLowerCase()));l.useEffect(()=>{if(!Ct||g!=="editor")return;const t=setTimeout(()=>{pe("syncing"),setTimeout(()=>{Fe(new Date),pe("synced")},800)},2e3);return()=>clearTimeout(t)},[b,G,w,Ct,g]),l.useEffect(()=>{const t=s=>{(s.metaKey||s.ctrlKey)&&s.key==="k"&&(s.preventDefault(),q(!0),setTimeout(()=>{var r;return(r=zt.current)==null?void 0:r.focus()},50)),s.key==="Escape"&&(q(!1),Q(!1),se(!1)),(s.metaKey||s.ctrlKey)&&s.key==="/"&&(s.preventDefault(),Q(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const $s=()=>{pe("syncing"),setTimeout(()=>{Fe(new Date),pe("synced"),O(t=>[...t,{id:Date.now().toString(),message:"Document saved",type:"success"}])},500)};l.useEffect(()=>{const t=setInterval(()=>{O(s=>s.length>0?s.slice(1):s)},4e3);return()=>clearInterval(t)},[]);const Ds=()=>{const t=["#EC4899","#3B82F6","#10B981","#F59E0B","#8B5CF6","#EF4444","#06B6D4","#84CC16"];return t[Math.floor(Math.random()*t.length)]},At=()=>{if(!F.trim()||!F.includes("@")){O(a=>[...a,{id:Date.now().toString(),message:"Please enter a valid email",type:"warning"}]);return}if(R.some(a=>a.id===F.toLowerCase())){O(a=>[...a,{id:Date.now().toString(),message:"User already invited",type:"warning"}]);return}const s=F.split("@")[0].replace(/[._]/g," ").split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),r={id:F.toLowerCase(),name:s,email:F.toLowerCase(),color:Ds(),permission:Nt,avatar:void 0,cursor:void 0,invitedAt:new Date};We(a=>[...a,r]),vt(""),O(a=>[...a,{id:Date.now().toString(),message:`Invitation sent to ${F}`,type:"success"}])},Ts=t=>{We(s=>s.filter(r=>r.id!==t)),O(s=>[...s,{id:Date.now().toString(),message:"Collaborator removed",type:"info"}])},Ps=(t,s)=>{We(r=>r.map(a=>a.id===t?{...a,permission:s}:a))},$t=l.useCallback(t=>{ut(!0),t.preventDefault()},[]);l.useEffect(()=>{const t=r=>{var i;if(!Z)return;const a=(i=Re.current)==null?void 0:i.getBoundingClientRect();if(!a)return;const n=r.clientX-a.left,m=Math.max(200,Math.min(n,600));cs(m)},s=()=>ut(!1);return Z?(document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)}},[Z]),l.useEffect(()=>{const t=s=>{Ee.current&&!Ee.current.contains(s.target)&&Te(null),de&&!s.target.closest(".mode-selector")&&X(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[de]),l.useEffect(()=>{const t=s=>{if(g==="dashboard"){const r=s.key.toLowerCase();if(["INPUT","TEXTAREA"].includes(s.target.tagName))return;r==="d"&&(s.preventDefault(),A("docs")),r==="s"&&(s.preventDefault(),A("sheets")),r==="p"&&(s.preventDefault(),A("slides")),(s.metaKey||s.ctrlKey)&&r==="k"&&(s.preventDefault(),S("slides"),x("slide-setup"),E(!0))}else if(u==="slides"&&g==="editor"){if(["INPUT","TEXTAREA"].includes(s.target.tagName))return;s.key==="ArrowUp"||s.key==="ArrowLeft"?(s.preventDefault(),P(r=>Math.max(0,r-1))):(s.key==="ArrowDown"||s.key==="ArrowRight")&&(s.preventDefault(),P(r=>Math.min(w.length-1,r+1)))}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[u,g,w.length]);const A=(t="docs")=>{if(S(t),t==="slides"){x("slide-setup");return}if(t==="docs"){x("doc-setup");return}if(t==="sheets"){x("sheet-setup");return}C(t==="sheets"?"Untitled Spreadsheet":"Untitled document"),c(""),t==="sheets"&&(Ce(Array.from({length:J},()=>Array(ce).fill(""))),ze({r:0,c:0}),$e({})),x("editor")},Es=(t,s)=>{s&&xe(s),C("Untitled Presentation");const r=t==="fluid"?"title":t;U([{id:Date.now().toString(),layout:r,title:"New Presentation",subtitle:"Subtitle",body:""}]),P(0),x("editor")},Ms=t=>{const s=es.find(r=>r.id===t);ms(t),C(s?`New ${s.name}`:"Untitled Document"),c((s==null?void 0:s.content)||""),x("editor")},Is=t=>{const s=ts.find(r=>r.id===t);ps(t),C(s?`New ${s.name}`:"Untitled Spreadsheet"),Ce(Array.from({length:J},()=>Array(ce).fill(""))),ze({r:0,c:0}),$e({}),x("editor")},Ls=()=>{g==="editor"||g==="slide-setup"||g==="doc-setup"||g==="sheet-setup"?x("dashboard"):D()},Ve=t=>y(s=>({...s,[t]:!s[t]})),fe=t=>y(s=>({...s,align:t})),Dt=t=>y(s=>({...s,list:s.list===t?null:t})),Rs=t=>Te(De===t?null:t),Fs=()=>{const t=Date.now().toString();ss([...Pe,{id:t,title:`Section ${Pe.length+1}`}]),ot(t)},Ke=(t,s,r)=>{const a=[...G];a[t]=[...a[t]],a[t][s]=r,Ce(a)},ae=(t,s)=>{if(!d)return;const r=`${d.r}-${d.c}`;$e(a=>{const n=a[r]||{};let m={...n};return t==="fontWeight"?m.fontWeight=n.fontWeight==="bold"?"normal":"bold":t==="fontStyle"?m.fontStyle=n.fontStyle==="italic"?"normal":"italic":t==="textDecoration"?m.textDecoration=n.textDecoration==="line-through"?"none":"line-through":m={...m,[t]:s},{...a,[r]:m}})},Os=()=>{const t={id:Date.now().toString(),layout:"content",title:"New Slide",subtitle:"",body:"â€¢ Click to edit text"},s=[...w];s.splice($+1,0,t),U(s),P($+1)},Bs=b.trim()?b.trim().split(/\s+/).length:0,Gs=b.length,Tt=l.useCallback(()=>{const t={title:N,content:b,docType:u,slides:w,sheetData:G};localStorage.setItem("sai-current-doc",JSON.stringify(t)),Fe(new Date);const r=[{id:Date.now().toString(),title:N||"Untitled",type:u,lastEdited:new Date().toISOString()},...ue.filter(a=>a.title!==N).slice(0,4)];ds(r),localStorage.setItem("sai-recent-docs",JSON.stringify(r))},[N,b,u,w,G,ue]);l.useEffect(()=>{if(g!=="editor")return;const t=setInterval(Tt,3e4);return()=>clearInterval(t)},[g,Tt]);const je=async t=>{if(b.trim()){bt(!0);try{const s={improve:`Improve the writing quality, clarity, and flow of this text while keeping the same meaning:

${b}`,summarize:`Summarize this text concisely:

${b}`,expand:`Expand on this text with more details and examples:

${b}`,fix:`Fix any grammar, spelling, and punctuation errors in this text:

${b}`},r=await Xt.getChatResponse({prompt:s[t],modelId:k||"gemini-2.5-flash"});r.text&&c(r.text)}catch(s){console.error("AI assist error:",s)}finally{bt(!1)}}},Us=async()=>{if(H.trim()){xt(!0);try{const t=`Create a professional presentation deck about: "${H}".

Requirements:
- Exactly ${dt} slides
- Each slide must have meaningful content
- First slide should be a title slide
- DO NOT use markdown formatting (no #, **, *, etc.)
- Use plain bullet points with "â€¢ " character only
- Write content as plain readable text

Return a valid JSON object with this exact structure:
{
  "slides": [
    {
      "layout": "title",
      "title": "Main Presentation Title",
      "subtitle": "Subtitle or tagline",
      "body": ""
    },
    {
      "layout": "content",
      "title": "Slide Title",
      "subtitle": "",
      "body": "â€¢ First key point here\\nâ€¢ Second key point here\\nâ€¢ Third key point here"
    }
  ]
}

IMPORTANT: 
- Use "â€¢ " (bullet character) NOT "- " or "* "
- No markdown headers (no # symbols)
- No bold/italic markers (no ** or *)
- Just plain text with bullet points
- Layout options: "title", "content", "section", "two-column"
- Make the content informative and professional.`,r=(await Xt.getChatResponse({prompt:t,modelId:k||"gemini-2.5-flash",responseMimeType:"application/json"})).text||"";console.log("AI Slide Response:",r);let a=r.replace(/```json|```/g,"").trim();const n=a.match(/\{[\s\S]*\}/);n&&(a=n[0]);const m=JSON.parse(a),i=_=>_?_.replace(/^#{1,6}\s*/gm,"").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/^[\-\*]\s/gm,"â€¢ ").replace(/`([^`]+)`/g,"$1").trim():"";if(m.slides&&Array.isArray(m.slides)&&m.slides.length>0){const _=m.slides.map((Ne,It)=>({id:Date.now().toString()+It,layout:Ne.layout||"content",title:i(Ne.title)||`Slide ${It+1}`,subtitle:i(Ne.subtitle)||"",body:i(Ne.body)||""}));U(_),P(0),E(!1),he("")}else{console.error("Invalid slide data, creating defaults");const _=[{id:Date.now().toString()+"0",layout:"title",title:H,subtitle:"AI Generated Presentation",body:""},{id:Date.now().toString()+"1",layout:"content",title:"Overview",subtitle:"",body:`â€¢ Key point 1
â€¢ Key point 2
â€¢ Key point 3`}];U(_),P(0),E(!1),he("")}}catch(t){console.error("Slide generation error:",t);const s=[{id:Date.now().toString()+"0",layout:"title",title:H,subtitle:"Presentation",body:""},{id:Date.now().toString()+"1",layout:"content",title:"Content",subtitle:"",body:"Add your content here"}];U(s),P(0),E(!1)}finally{xt(!1)}}},j=(t,s)=>{const r=[...w];r[$]={...r[$],[t]:s},U(r)},ve=t=>{Le(!1);const s=new Date().toISOString().slice(0,10);let r=N.replace(/\s+/g,"_")+`_${s}`,a="";switch(t){case"csv":r+=".csv",a=G.map(n=>n.join(",")).join(`
`);break;case"doc":r+=".doc",a=b;break;case"pdf":r+=".pdf",a=b;break;case"ppt":r+=".pptx",a=JSON.stringify(w);break}if(t==="csv"){const n=new Blob([a],{type:"text/csv"}),m=URL.createObjectURL(n),i=document.createElement("a");i.href=m,i.download=r,i.click()}else alert(`Exporting to ${t.toUpperCase()}...`)},Ws=()=>{switch(u){case"sheets":return e.jsx(_t,{size:18,className:"text-emerald-400"});case"slides":return e.jsx(Y,{size:18,className:"text-orange-400"});default:return e.jsx(T,{size:18,className:"text-blue-600"})}},Vs=[{label:"File",items:["New","Open","Make a copy","Share","Email","Download","Rename","Move to trash"]},{label:"Edit",items:["Undo","Redo","Cut","Copy","Paste","Select all","Find and replace"]},{label:"View",items:["Mode","Show print layout","Show ruler","Show outline","Full screen"]},{label:"Insert",items:["Image","Table","Drawing","Chart","Horizontal line","Date","Footnote"]},{label:"Format",items:["Text","Paragraph styles","Align & indent","Line & paragraph spacing","Columns","Bullets & numbering"]},{label:"Tools",items:["Spelling and grammar","Word count","Review suggested edits","Compare documents","Citations"]},{label:"Extensions",items:["Add-ons","Apps script"]},{label:"Help",items:["Help","Training","Updates"]}],le=t=>{if(!t)return null;const s=t.split(`
`);return e.jsx("div",{className:"space-y-2",children:s.map((r,a)=>{const n=r.trim();if(!n)return e.jsx("div",{className:"h-2"},a);if(/^[â€¢\-\*]\s/.test(n)){const m=n.replace(/^[â€¢\-\*]\s*/,"");return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-current opacity-60 mt-1",children:"â€¢"}),e.jsx("span",{children:He(m)})]},a)}if(/^\d+[\.\)]\s/.test(n)){const m=n.match(/^(\d+)[\.\)]\s*(.*)/);if(m)return e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"text-current opacity-60 font-semibold min-w-[1.5rem]",children:[m[1],"."]}),e.jsx("span",{children:He(m[2])})]},a)}if(/^#{1,3}\s/.test(n)){const m=n.replace(/^#{1,3}\s*/,"");return e.jsx("div",{className:"font-bold text-lg mt-2",children:m},a)}return e.jsx("div",{children:He(n)},a)})})},He=t=>t.split(/(\*\*[^*]+\*\*|\*[^*]+\*)/g).map((r,a)=>r.startsWith("**")&&r.endsWith("**")?e.jsx("strong",{children:r.slice(2,-2)},a):r.startsWith("*")&&r.endsWith("*")?e.jsx("em",{children:r.slice(1,-1)},a):r),Pt=({slide:t,theme:s,scale:r=1,editable:a=!0})=>{const n=B[s]||B.midnight;if(!n)return null;const m={transform:`scale(${r})`,transformOrigin:"top left",width:"100%",height:"100%"};return e.jsx("div",{className:`w-full h-full ${n.bg} ${n.text} overflow-hidden relative shadow-inner`,style:a?{}:m,children:e.jsxs("div",{className:"absolute inset-0 p-[8%]",children:[t.layout==="title"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center space-y-4",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-5xl font-black text-center outline-none placeholder-white/30 w-full ${n.text}`,placeholder:"Title"}):e.jsx("h1",{className:"text-5xl font-black",children:t.title}),a?e.jsx("input",{value:t.subtitle,onChange:i=>j("subtitle",i.target.value),className:`bg-transparent text-2xl font-medium text-center outline-none w-full opacity-80 ${n.text}`,placeholder:"Subtitle"}):e.jsx("h2",{className:"text-2xl font-medium opacity-80",children:t.subtitle})]}),t.layout==="content"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-6 border-b-2 ${n.border} pb-4 w-full ${n.text}`,placeholder:"Slide Title"}):e.jsx("h1",{className:`text-4xl font-bold mb-6 border-b-2 ${n.border} pb-4`,children:t.title}),a?e.jsx("textarea",{value:t.body,onChange:i=>j("body",i.target.value),className:`flex-1 bg-transparent text-xl outline-none resize-none leading-relaxed placeholder-white/30 ${n.text}`,placeholder:"â€¢ Click to add content"}):e.jsx("div",{className:"text-xl leading-relaxed flex-1 overflow-auto",children:le(t.body)})]}),t.layout==="big-number"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[a?e.jsx("input",{value:t.body,onChange:i=>j("body",i.target.value),className:`bg-transparent text-[12rem] font-black text-center outline-none w-full ${n.accent}`,placeholder:"0%"}):e.jsx("div",{className:`text-[12rem] font-black ${n.accent}`,children:t.body}),a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-3xl font-bold text-center outline-none mt-4 w-full ${n.text}`,placeholder:"Statistic Label"}):e.jsx("h2",{className:"text-3xl font-bold mt-4",children:t.title})]}),t.layout==="visual"&&e.jsxs("div",{className:"flex h-full gap-8",children:[e.jsxs("div",{className:"w-1/2 flex flex-col justify-center",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-4 ${n.text}`,placeholder:"Title"}):e.jsx("h1",{className:"text-4xl font-bold mb-4",children:t.title}),a?e.jsx("textarea",{value:t.subtitle,onChange:i=>j("subtitle",i.target.value),className:`bg-transparent text-lg outline-none resize-none h-40 opacity-80 ${n.text}`,placeholder:"Description..."}):e.jsx("p",{className:"text-lg opacity-80",children:t.subtitle})]}),e.jsx("div",{className:`w-1/2 rounded-xl flex items-center justify-center border-2 border-dashed ${n.border} bg-white/5`,children:e.jsxs("div",{className:"text-center opacity-50",children:[e.jsx(ne,{size:48,className:"mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-bold",children:"Image Placeholder"})]})})]}),t.layout==="two-column"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-6 border-b-2 ${n.border} pb-4 w-full ${n.text}`,placeholder:"Slide Title"}):e.jsx("h1",{className:`text-4xl font-bold mb-6 border-b-2 ${n.border} pb-4`,children:t.title}),e.jsxs("div",{className:"flex-1 flex gap-8",children:[e.jsx("div",{className:"flex-1",children:a?e.jsx("textarea",{value:t.leftContent||t.body,onChange:i=>j("body",i.target.value),className:`w-full h-full bg-transparent text-lg outline-none resize-none leading-relaxed placeholder-white/30 ${n.text}`,placeholder:"Left column content..."}):e.jsx("div",{className:"text-lg",children:le(t.leftContent||t.body)})}),e.jsx("div",{className:`w-px ${n.border} border-l`}),e.jsx("div",{className:"flex-1",children:a?e.jsx("textarea",{value:t.rightContent||"",onChange:i=>j("subtitle",i.target.value),className:`w-full h-full bg-transparent text-lg outline-none resize-none leading-relaxed placeholder-white/30 ${n.text}`,placeholder:"Right column content..."}):e.jsx("div",{className:"text-lg",children:le(t.rightContent||t.subtitle)})})]})]}),t.layout==="comparison"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-6 text-center w-full ${n.text}`,placeholder:"Comparison Title"}):e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:t.title}),e.jsxs("div",{className:"flex-1 flex gap-6",children:[e.jsxs("div",{className:`flex-1 rounded-2xl p-6 border-2 ${n.border} bg-white/5`,children:[e.jsx("h3",{className:`text-xl font-bold mb-4 ${n.accent}`,children:"Before"}),a?e.jsx("textarea",{value:t.body,onChange:i=>j("body",i.target.value),className:`w-full h-32 bg-transparent outline-none resize-none ${n.text}`,placeholder:"Before state..."}):e.jsx("div",{className:"text-base",children:le(t.body)})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(nt,{size:32,className:`${n.accent}`})}),e.jsxs("div",{className:`flex-1 rounded-2xl p-6 border-2 ${n.border} bg-white/5`,children:[e.jsx("h3",{className:`text-xl font-bold mb-4 ${n.accent}`,children:"After"}),a?e.jsx("textarea",{value:t.subtitle,onChange:i=>j("subtitle",i.target.value),className:`w-full h-32 bg-transparent outline-none resize-none ${n.text}`,placeholder:"After state..."}):e.jsx("div",{className:"text-base",children:le(t.subtitle)})]})]})]}),t.layout==="timeline"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-8 w-full ${n.text}`,placeholder:"Timeline Title"}):e.jsx("h1",{className:"text-4xl font-bold mb-8",children:t.title}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:`absolute top-1/2 left-0 right-0 h-1 ${n.accent} bg-current opacity-30 rounded-full`}),e.jsx("div",{className:"flex justify-between relative",children:[1,2,3,4].map(i=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${n.accent} bg-current flex items-center justify-center text-xl font-bold mb-3`,children:e.jsx("span",{className:(n.bg.includes("from-slate-900")||n.bg.includes("from-[#1")||n.bg.includes("from-cyan"),"text-white"),children:i})}),e.jsxs("span",{className:`text-sm font-medium ${n.text} opacity-70`,children:["Phase ",i]})]},i))})]})}),a?e.jsx("textarea",{value:t.body,onChange:i=>j("body",i.target.value),className:`bg-transparent text-lg outline-none resize-none h-20 mt-4 ${n.text}`,placeholder:"Timeline description..."}):e.jsx("p",{className:"text-lg mt-4",children:t.body})]}),t.layout==="quote"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8",children:[e.jsx("div",{className:`text-8xl ${n.accent} opacity-30 mb-4`,children:'"'}),a?e.jsx("textarea",{value:t.body,onChange:i=>j("body",i.target.value),className:`bg-transparent text-3xl font-medium text-center outline-none resize-none w-full leading-relaxed italic ${n.text}`,placeholder:"Enter your quote here..."}):e.jsx("blockquote",{className:"text-3xl font-medium italic leading-relaxed",children:t.body}),a?e.jsx("input",{value:t.subtitle,onChange:i=>j("subtitle",i.target.value),className:`bg-transparent text-xl font-bold text-center outline-none mt-8 w-full ${n.accent}`,placeholder:"â€” Author Name"}):e.jsx("cite",{className:`text-xl font-bold mt-8 ${n.accent} not-italic`,children:t.subtitle})]}),t.layout==="gallery"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-6 w-full ${n.text}`,placeholder:"Gallery Title"}):e.jsx("h1",{className:"text-4xl font-bold mb-6",children:t.title}),e.jsx("div",{className:"flex-1 grid grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(i=>e.jsx("div",{className:`rounded-xl flex items-center justify-center border-2 border-dashed ${n.border} bg-white/5`,children:e.jsxs("div",{className:"text-center opacity-40",children:[e.jsx(ne,{size:24,className:"mx-auto mb-1"}),e.jsxs("span",{className:"text-[10px] font-bold",children:["Image ",i]})]})},i))})]}),t.layout==="team"&&e.jsxs("div",{className:"flex flex-col h-full",children:[a?e.jsx("input",{value:t.title,onChange:i=>j("title",i.target.value),className:`bg-transparent text-4xl font-bold outline-none mb-8 text-center w-full ${n.text}`,placeholder:"Meet the Team"}):e.jsx("h1",{className:"text-4xl font-bold mb-8 text-center",children:t.title}),e.jsx("div",{className:"flex-1 flex justify-center items-center gap-8",children:[1,2,3,4].map(i=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-20 h-20 rounded-full ${n.border} border-2 bg-white/10 flex items-center justify-center mb-3`,children:e.jsx(Sa,{size:32,className:`${n.accent}`})}),e.jsx("span",{className:`text-sm font-bold ${n.text}`,children:"Team Member"}),e.jsx("span",{className:`text-xs ${n.text} opacity-60`,children:"Role"})]},i))})]})]})})};return g==="dashboard"?e.jsxs("div",{className:"flex h-full w-full bg-[#faf8f5] text-slate-800 font-sans overflow-y-auto overflow-x-hidden relative dashboard-root",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    .dashboard-root {
                      --bg: #faf8f5;
                      --panel: #ffffff;
                      --text: #1e293b;
                      --muted: #64748b;
                      --ring: rgba(0,0,0,0.06);
                      --blue: #3b82f6;
                      --green: #10b981;
                      --orange: #f97316;
                      background:
                        radial-gradient(1000px 600px at 15% -10%, rgba(59,130,246,0.08), transparent 60%),
                        radial-gradient(900px 500px at 90% 10%, rgba(16,185,129,0.06), transparent 55%),
                        radial-gradient(800px 500px at 50% 120%, rgba(249,115,22,0.06), transparent 60%),
                        var(--bg);
                      color: var(--text);
                    }

                    .overlay {
                      max-width: 1200px;
                      margin: 0 auto;
                      padding: 72px 64px 96px;
                      position: relative;
                      animation: fadeUp .8s cubic-bezier(.2,.8,.2,1) both;
                    }

                    @keyframes fadeUp {
                      from { opacity: 0; transform: translateY(12px); }
                      to { opacity: 1; transform: translateY(0); }
                    }

                    .close-btn {
                      position: absolute;
                      top: 48px;
                      right: 64px;
                      width: 44px; height: 44px;
                      border-radius: 12px;
                      display: grid;
                      place-items: center;
                      background: white;
                      box-shadow: 0 2px 8px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04);
                      font-size: 22px;
                      cursor: pointer;
                      transition: transform .2s ease, box-shadow .2s ease;
                      border: none;
                      z-index: 50;
                      color: #64748b;
                    }

                    .close-btn:hover { transform: scale(1.08); box-shadow: 0 4px 12px rgba(0,0,0,0.12); color: #1e293b; }

                    .eyebrow { font-size: 12px; letter-spacing: 1.6px; text-transform: uppercase; color: var(--muted); font-weight: 700; margin-bottom: 14px; }
                    .hero-h1 { font-size: 48px; font-weight: 800; margin: 0 0 12px 0; letter-spacing: -0.02em; color: var(--text); background: linear-gradient(135deg, #1e293b 0%, #475569 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
                    .dashboard-subtitle { font-size: 18px; color: var(--muted); margin-bottom: 64px; max-width: 640px; }
                    .creative-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }

                    .creative-card {
                      position: relative; border-radius: 20px; padding: 24px; background: white;
                      box-shadow: 0 4px 24px rgba(0,0,0,0.06), 0 0 0 1px rgba(0,0,0,0.04);
                      cursor: pointer; display: flex; flex-direction: column; gap: 12px; overflow: hidden;
                      transition: transform .4s cubic-bezier(.2,.8,.2,1), box-shadow .4s ease, border-color .3s; border: 1px solid rgba(0,0,0,0.04); text-align: left;
                    }

                    .creative-card:hover { transform: translateY(-6px); box-shadow: 0 20px 48px rgba(0,0,0,0.1); border-color: rgba(0,0,0,0.08); }
                    .creative-card:hover.docs-card { border-color: rgba(59,130,246,0.4); }
                    .creative-card:hover.sheets-card { border-color: rgba(16,185,129,0.4); }
                    .creative-card:hover.slides-card { border-color: rgba(249,115,22,0.4); }

                    .creative-icon { width: 48px; height: 48px; border-radius: 14px; display: grid; place-items: center; font-size: 22px; font-weight: 800; color: white; box-shadow: 0 8px 16px rgba(0,0,0,0.3); }
                    .docs-grad { background: linear-gradient(135deg, var(--blue), #2563eb); }
                    .sheets-grad { background: linear-gradient(135deg, var(--green), #059669); }
                    .slides-grad { background: linear-gradient(135deg, var(--orange), #ea580c); }

                    .creative-card h3 { margin: 0; font-size: 18px; font-weight: 700; color: var(--text); }
                    .creative-card p { margin: 0; font-size: 13px; color: var(--muted); line-height: 1.5; }
                    .hint { margin-top: auto; font-size: 11px; font-weight: 600; color: var(--muted); opacity: .7; }
                    .dashboard-cta { margin-top: 48px; display: flex; justify-content: center; gap: 12px; align-items: center; }

                    .dashboard-cta button { padding: 14px 32px; font-size: 14px; font-weight: 700; border-radius: 12px; border: none; cursor: pointer; background: linear-gradient(135deg, #8b5cf6, #6366f1); color: white; box-shadow: 0 15px 30px rgba(139,92,246,.25); transition: transform .2s ease, box-shadow .2s ease; }
                    .dashboard-cta button:hover { transform: translateY(-2px); box-shadow: 0 25px 45px rgba(139,92,246,.35); }

                    .kbd-key { font-size: 11px; padding: 4px 8px; border-radius: 6px; background: #f1f5f9; box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08); font-weight: 600; color: var(--muted); }
                    .recent-sec { margin-top: 56px; }
                    .recent-sec h4 { margin: 0 0 16px; font-size: 11px; letter-spacing: 1.2px; text-transform: uppercase; color: var(--muted); font-weight: 700; }

                    @media (max-width: 768px) { .overlay { padding: 48px 24px 72px; } .close-btn { right: 24px; top: 32px; } .hero-h1 { font-size: 28px; } .creative-cards { grid-template-columns: 1fr; } }
                `}}),e.jsxs("div",{className:"overlay",children:[e.jsx("button",{onClick:D,className:"close-btn",children:"Ã—"}),e.jsx("div",{className:"eyebrow",children:"Document Studio"}),e.jsx("h1",{className:"hero-h1",children:"Create professional assets in seconds"}),e.jsx("p",{className:"dashboard-subtitle",children:"Start with a smart format or use AI to generate your first draft instantly."}),e.jsxs("div",{className:"creative-cards",children:[e.jsxs("button",{className:"creative-card docs-card",onClick:()=>A("docs"),children:[e.jsx("div",{className:"creative-icon docs-grad",children:"ðŸ“„"}),e.jsx("h3",{children:"Docs"}),e.jsx("p",{children:"Write proposals and technical documentation with AI assistance."}),e.jsxs("div",{className:"hint",children:["Press ",e.jsx("span",{className:"kbd-key",children:"D"})," to start"]})]}),e.jsxs("button",{className:"creative-card sheets-card",onClick:()=>A("sheets"),children:[e.jsx("div",{className:"creative-icon sheets-grad",children:"ðŸ“Š"}),e.jsx("h3",{children:"Sheets"}),e.jsx("p",{children:"Track metrics and manage data with powerful formulas."}),e.jsxs("div",{className:"hint",children:["Press ",e.jsx("span",{className:"kbd-key",children:"S"})," to start"]})]}),e.jsxs("button",{className:"creative-card slides-card",onClick:()=>A("slides"),children:[e.jsx("div",{className:"creative-icon slides-grad",children:"ðŸŽ¨"}),e.jsx("h3",{children:"Slides"}),e.jsx("p",{children:"Design beautiful presentations like Gamma.app."}),e.jsxs("div",{className:"hint",children:["Press ",e.jsx("span",{className:"kbd-key",children:"P"})," to start"]})]})]}),e.jsxs("div",{className:"dashboard-cta",children:[e.jsx("button",{onClick:()=>{S("slides"),x("slide-setup"),E(!0)},children:"âœ¨ Generate with AI"}),e.jsx("span",{className:"kbd-key",children:"âŒ˜K"})]}),e.jsxs("div",{className:"recent-sec",children:[e.jsx("h4",{children:"Recent Documents"}),ue.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:ue.map(t=>e.jsxs("button",{onClick:()=>{S(t.type),C(t.title),t.type,x("editor")},className:"flex items-center gap-3 p-4 bg-white rounded-xl border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left group",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.type==="docs"?"bg-blue-100 text-blue-600":t.type==="sheets"?"bg-emerald-100 text-emerald-600":"bg-orange-100 text-orange-600"}`,children:t.type==="docs"?e.jsx(T,{size:18}):t.type==="sheets"?e.jsx(re,{size:18}):e.jsx(Y,{size:18})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-slate-800 truncate text-sm",children:t.title}),e.jsx("div",{className:"text-xs text-slate-500",children:new Date(t.lastEdited).toLocaleDateString()})]})]},t.id))}):e.jsx("div",{className:"flex items-center justify-center py-12 opacity-40 border border-dashed border-slate-300 rounded-2xl w-full",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx(_s,{size:32,strokeWidth:1.5}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"No recent documents"})]})})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h4",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Pro Tips"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{size:16,className:"text-purple-500"}),e.jsx("span",{className:"text-xs font-bold text-purple-700",children:"Keyboard Power"})]}),e.jsxs("p",{className:"text-xs text-slate-600",children:["Press ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white rounded text-[10px] font-mono border",children:"âŒ˜K"})," anywhere to open the command palette for quick actions."]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{size:16,className:"text-blue-500"}),e.jsx("span",{className:"text-xs font-bold text-blue-700",children:"AI Magic"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:'Select any text and click "AI Assist" to improve, expand, or summarize your content instantly.'})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ft,{size:16,className:"text-emerald-500"}),e.jsx("span",{className:"text-xs font-bold text-emerald-700",children:"Auto-Save"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"Your work is automatically saved every 30 seconds. Look for the sync indicator in the header."})]})]})]})]}),js&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-start justify-center pt-[15vh] animate-fade-in",onClick:()=>q(!1),children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-slate-100",children:[e.jsx(Ot,{size:18,className:"text-slate-400"}),e.jsx("input",{ref:zt,type:"text",value:yt,onChange:t=>wt(t.target.value),placeholder:"Type a command or search...",className:"flex-1 bg-transparent outline-none text-slate-800 placeholder-slate-400",autoFocus:!0}),e.jsx("kbd",{className:"text-[10px] px-2 py-1 bg-slate-100 rounded text-slate-500 font-semibold",children:"ESC"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto py-2",children:As.map(t=>e.jsxs("button",{onClick:()=>{t.action(),q(!1),wt("")},className:"w-full flex items-center gap-3 px-4 py-2.5 hover:bg-slate-50 transition-colors text-left",children:[e.jsx(t.icon,{size:16,className:"text-slate-500"}),e.jsx("span",{className:"flex-1 text-sm text-slate-700",children:t.label}),e.jsx("kbd",{className:"text-[10px] px-2 py-0.5 bg-slate-100 rounded text-slate-400 font-mono",children:t.shortcut})]},t.id))}),e.jsxs("div",{className:"px-4 py-2 border-t border-slate-100 bg-slate-50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] text-slate-400",children:["Tip: Use ",e.jsx("kbd",{className:"px-1 bg-white rounded text-slate-500",children:"â†‘â†“"})," to navigate"]}),e.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:[e.jsx(Ys,{size:10})," Quick Actions"]})]})]})}),vs&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center animate-fade-in",onClick:()=>Q(!1),children:e.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{size:20,className:"text-purple-500"}),e.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Keyboard Shortcuts"})]}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(I,{size:18})})]}),e.jsxs("div",{className:"p-6 grid grid-cols-2 gap-6 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"General"}),e.jsx("div",{className:"space-y-2",children:[{keys:["âŒ˜","K"],desc:"Command Palette"},{keys:["âŒ˜","S"],desc:"Save Document"},{keys:["âŒ˜","Z"],desc:"Undo"},{keys:["âŒ˜","â‡§","Z"],desc:"Redo"},{keys:["âŒ˜","/"],desc:"Keyboard Shortcuts"}].map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-slate-600",children:t.desc}),e.jsx("div",{className:"flex gap-1",children:t.keys.map((r,a)=>e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-semibold text-slate-600",children:r},a))})]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Create"}),e.jsx("div",{className:"space-y-2",children:[{keys:["D"],desc:"New Document"},{keys:["S"],desc:"New Spreadsheet"},{keys:["P"],desc:"New Presentation"},{keys:["âŒ˜","N"],desc:"New from Template"}].map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-slate-600",children:t.desc}),e.jsx("div",{className:"flex gap-1",children:t.keys.map((r,a)=>e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-semibold text-slate-600",children:r},a))})]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Formatting"}),e.jsx("div",{className:"space-y-2",children:[{keys:["âŒ˜","B"],desc:"Bold"},{keys:["âŒ˜","I"],desc:"Italic"},{keys:["âŒ˜","U"],desc:"Underline"},{keys:["âŒ˜","â‡§","F"],desc:"Focus Mode"}].map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-slate-600",children:t.desc}),e.jsx("div",{className:"flex gap-1",children:t.keys.map((r,a)=>e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-semibold text-slate-600",children:r},a))})]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Slides"}),e.jsx("div",{className:"space-y-2",children:[{keys:["â†","â†’"],desc:"Navigate Slides"},{keys:["âŒ˜","Enter"],desc:"Present"},{keys:["N"],desc:"Add New Slide"},{keys:["Delete"],desc:"Delete Slide"}].map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-sm text-slate-600",children:t.desc}),e.jsx("div",{className:"flex gap-1",children:t.keys.map((r,a)=>e.jsx("kbd",{className:"px-2 py-1 bg-slate-100 rounded text-xs font-semibold text-slate-600",children:r},a))})]},s))})]})]})]})}),ys&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-center justify-center animate-fade-in",onClick:()=>se(!1),children:e.jsxs("div",{className:"w-full max-w-lg bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Share Document"}),e.jsx("button",{onClick:()=>se(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(I,{size:18})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Invite People"}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"email",value:F,onChange:t=>vt(t.target.value),onKeyDown:t=>t.key==="Enter"&&At(),placeholder:"Enter email address...",className:"flex-1 px-4 py-2.5 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsxs("select",{value:Nt,onChange:t=>ks(t.target.value),className:"px-3 py-2.5 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",children:[e.jsx("option",{value:"edit",children:"Can edit"}),e.jsx("option",{value:"comment",children:"Can comment"}),e.jsx("option",{value:"view",children:"Can view"})]}),e.jsx("button",{onClick:At,className:"px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-semibold text-sm transition-colors",children:"Invite"})]})]}),R.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:["People with access (",R.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:R.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl hover:bg-slate-50 transition-colors group",children:[e.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center font-bold text-xs text-white shrink-0",style:{backgroundColor:t.color},children:t.name.split(" ").map(s=>s[0]).join("").slice(0,2).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-700 truncate",children:t.name}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:t.email||t.id})]}),e.jsxs("select",{value:t.permission||"edit",onChange:s=>Ps(t.id,s.target.value),className:"px-2 py-1 text-xs border border-slate-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-purple-500 bg-white",children:[e.jsx("option",{value:"edit",children:"Can edit"}),e.jsx("option",{value:"comment",children:"Can comment"}),e.jsx("option",{value:"view",children:"Can view"})]}),e.jsx("button",{onClick:()=>Ts(t.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(I,{size:14})})]},t.id))})]}),e.jsx("div",{className:"mb-6 pb-4 border-b border-slate-100",children:e.jsx("div",{className:"flex items-center gap-3 p-2",children:h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center font-bold text-xs text-white",children:h.initials}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-700",children:[h.name," (You)"]}),e.jsx("div",{className:"text-xs text-slate-500",children:h.email||"Owner"})]}),e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-lg",children:"Owner"})]})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3",children:"General Access"}),e.jsx("div",{className:"space-y-2",children:[{id:"private",label:"Restricted",desc:"Only people with access can open",icon:Js},{id:"view",label:"Anyone with link can view",desc:"Anyone with the link can view",icon:Qe},{id:"edit",label:"Anyone with link can edit",desc:"Anyone with the link can edit",icon:_e}].map(t=>e.jsxs("button",{onClick:()=>ws(t.id),className:`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${ge===t.id?"border-purple-500 bg-purple-50":"border-slate-200 hover:border-slate-300"}`,children:[e.jsx(t.icon,{size:16,className:ge===t.id?"text-purple-600":"text-slate-500"}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:`text-sm font-semibold ${ge===t.id?"text-purple-700":"text-slate-700"}`,children:t.label}),e.jsx("div",{className:"text-xs text-slate-500",children:t.desc})]}),ge===t.id&&e.jsx(we,{size:16,className:"text-purple-600"})]},t.id))})]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/doc/${docTitle.replace(/\s+/g,"-").toLowerCase()}`),O(t=>[...t,{id:Date.now().toString(),message:"Link copied to clipboard",type:"success"}])},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-semibold text-sm transition-colors",children:[e.jsx(Xs,{size:16})," Copy Link"]})]})]})}),e.jsx("div",{className:"fixed bottom-8 right-8 z-50",children:e.jsxs("div",{className:"relative group",children:[e.jsx("button",{onClick:()=>q(!0),className:"w-14 h-14 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-full shadow-xl hover:shadow-2xl flex items-center justify-center text-white transition-all hover:scale-105 group-hover:from-purple-500 group-hover:to-indigo-500",children:e.jsx(L,{size:24})}),e.jsxs("div",{className:"absolute bottom-16 right-0 flex flex-col gap-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all",children:[e.jsxs("button",{onClick:()=>A("docs"),className:"flex items-center gap-3 px-4 py-2.5 bg-white rounded-xl shadow-lg hover:shadow-xl text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-all whitespace-nowrap",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(T,{size:14,className:"text-blue-600"})}),"New Document"]}),e.jsxs("button",{onClick:()=>A("sheets"),className:"flex items-center gap-3 px-4 py-2.5 bg-white rounded-xl shadow-lg hover:shadow-xl text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-all whitespace-nowrap",children:[e.jsx("div",{className:"p-1.5 bg-emerald-100 rounded-lg",children:e.jsx(re,{size:14,className:"text-emerald-600"})}),"New Spreadsheet"]}),e.jsxs("button",{onClick:()=>A("slides"),className:"flex items-center gap-3 px-4 py-2.5 bg-white rounded-xl shadow-lg hover:shadow-xl text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-all whitespace-nowrap",children:[e.jsx("div",{className:"p-1.5 bg-orange-100 rounded-lg",children:e.jsx(Y,{size:14,className:"text-orange-600"})}),"New Presentation"]}),e.jsxs("button",{onClick:()=>{S("slides"),x("slide-setup"),E(!0)},className:"flex items-center gap-3 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl shadow-lg hover:shadow-xl text-sm font-semibold text-white transition-all whitespace-nowrap",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg",children:e.jsx(v,{size:14})}),"Generate with AI"]})]})]})})]}):g==="slide-setup"?e.jsx(Da,{onBack:()=>x("dashboard"),onSelect:Es}):g==="doc-setup"?e.jsx(Aa,{onBack:()=>x("dashboard"),onSelect:Ms}):g==="sheet-setup"?e.jsx($a,{onBack:()=>x("dashboard"),onSelect:Is}):e.jsxs("div",{className:"flex h-full w-full overflow-hidden text-sans flex-col relative font-sans bg-[#faf8f5]",children:[e.jsxs("header",{className:"h-14 flex items-center justify-between px-4 border-b flex-shrink-0 z-40 bg-white border-slate-200 text-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:Ls,className:"p-2 rounded-lg transition-colors flex items-center justify-center w-9 h-9 text-slate-500 hover:text-slate-800 hover:bg-slate-100",children:e.jsx(oe,{size:18})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${u==="docs"?"bg-blue-500/10":u==="slides"?"bg-orange-500/10":"bg-emerald-500/10"}`,children:Ws()}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:N,onChange:t=>C(t.target.value),className:"text-base font-semibold bg-transparent border-none outline-none p-0 h-6 text-slate-800"}),e.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[10px] font-semibold transition-all ${W==="synced"?"bg-emerald-100 text-emerald-700":W==="syncing"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-500"}`,children:[W==="synced"&&e.jsx(Ft,{size:10}),W==="syncing"&&e.jsx(Ye,{size:10,className:"animate-spin"}),W==="offline"&&e.jsx(Zs,{size:10}),W==="synced"?"Saved":W==="syncing"?"Saving...":"Offline"]})]}),u==="docs"&&e.jsx("div",{className:"flex gap-4 text-[13px] text-slate-500 mt-0.5 select-none relative",ref:Ee,children:Vs.map(t=>e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:`hover:bg-slate-100 px-2 py-0.5 rounded cursor-pointer transition-colors ${De===t.label?"bg-slate-200":""}`,onClick:()=>Rs(t.label),children:t.label}),De===t.label&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white border border-slate-200 rounded-lg shadow-xl z-50 py-1 flex flex-col animate-fade-in origin-top-left",children:t.items.map(s=>e.jsx("button",{className:"text-left px-4 py-2 hover:bg-slate-100 text-slate-700 text-sm w-full",onClick:()=>Te(null),children:s},s))})]},t.label))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>q(!0),className:"hidden md:flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors text-sm text-slate-600",children:[e.jsx(Ot,{size:14}),e.jsx("span",{children:"Search"}),e.jsx("kbd",{className:"text-[10px] px-1.5 py-0.5 bg-white rounded text-slate-400 font-mono",children:"âŒ˜K"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-1 border-r border-slate-200 pr-3",children:[e.jsx("button",{onClick:()=>Q(!0),className:"p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",title:"Keyboard Shortcuts",children:e.jsx(ye,{size:16})}),e.jsx("button",{onClick:()=>be(!0),className:"p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",title:"Version History",children:e.jsx(qe,{size:16})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>Le(!mt),className:"flex items-center gap-2 px-4 py-2 rounded-full font-semibold text-sm transition-all bg-slate-100 text-slate-700 hover:bg-slate-200",children:[e.jsx(rt,{size:16})," Export"]}),mt&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 rounded-xl shadow-2xl border z-50 overflow-hidden py-1 animate-fade-in bg-white border-slate-200",children:[u==="docs"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>ve("doc"),className:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-3 text-slate-700 hover:bg-slate-50",children:[e.jsx(T,{size:16,className:"text-blue-500"})," Microsoft Word (.doc)"]}),e.jsxs("button",{onClick:()=>ve("pdf"),className:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-3 text-slate-700 hover:bg-slate-50",children:[e.jsx(T,{size:16,className:"text-red-500"})," PDF Document (.pdf)"]})]}),u==="sheets"&&e.jsxs("button",{onClick:()=>ve("csv"),className:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-3 text-slate-700 hover:bg-slate-50",children:[e.jsx(re,{size:16,className:"text-green-500"})," Comma Separated (.csv)"]}),u==="slides"&&e.jsxs("button",{onClick:()=>ve("ppt"),className:"w-full text-left px-4 py-2.5 text-sm flex items-center gap-3 text-slate-700 hover:bg-slate-50",children:[e.jsx(Y,{size:16,className:"text-orange-500"})," PowerPoint (.pptx)"]})]})]}),u==="docs"&&e.jsx(e.Fragment,{children:e.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full",children:e.jsx(Bt,{size:20})})}),e.jsxs("button",{onClick:()=>se(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white font-semibold text-sm rounded-full hover:shadow-lg hover:scale-[1.02] transition-all",children:[e.jsx(Lt,{size:16})," Share"]}),e.jsxs("div",{className:"flex -space-x-2 ml-1",ref:ls,children:[R.length>0&&R.slice(0,3).map((t,s)=>e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white flex items-center justify-center font-bold text-[10px] text-white shadow-sm cursor-pointer hover:scale-110 transition-transform",style:{backgroundColor:t.color,zIndex:10-s},title:t.name,children:t.avatar?e.jsx("img",{src:t.avatar,className:"w-full h-full rounded-full object-cover"}):t.name.split(" ").map(r=>r[0]).join("").slice(0,2)},t.id)),R.length>3&&e.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-200 border-2 border-white flex items-center justify-center font-bold text-[10px] text-slate-600 shadow-sm",children:["+",R.length-3]}),h&&e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white flex items-center justify-center font-bold text-[10px] text-white shadow-sm z-20",title:`${h.name} (You)`,children:h.initials})]})]})]}),u==="docs"&&e.jsxs("div",{className:"bg-[#f9fbfd] border-b border-gray-300 px-4 py-1.5 flex items-center gap-1 flex-wrap shrink-0 rounded-[28px] mx-2 my-1.5 shadow-sm select-none",children:[e.jsxs("div",{className:"flex gap-1 pr-2 border-r border-gray-300",children:[e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Je,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Xe,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ea,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Gt,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ta,{size:16})})]}),e.jsxs("div",{className:"flex gap-2 items-center px-2 border-r border-gray-300 h-6",children:[e.jsxs("button",{className:"flex items-center gap-1 text-xs text-gray-700 hover:bg-gray-200 px-1 rounded",children:["100% ",e.jsx(z,{size:12})]}),e.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),e.jsxs("button",{className:"flex items-center gap-1 text-xs text-gray-700 hover:bg-gray-200 px-1 rounded",children:["Normal text ",e.jsx(z,{size:12})]}),e.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),e.jsxs("button",{className:"flex items-center gap-1 text-xs text-gray-700 hover:bg-gray-200 px-1 rounded font-sans",children:["Arial ",e.jsx(z,{size:12})]}),e.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>f(Math.max(1,o-1)),className:"p-0.5 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ke,{size:12})}),e.jsx("input",{className:"w-8 text-center bg-transparent border border-gray-300 rounded text-xs py-0.5",value:o,onChange:t=>f(Number(t.target.value))}),e.jsx("button",{onClick:()=>f(o+1),className:"p-0.5 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(L,{size:12})})]})]}),e.jsxs("div",{className:"flex gap-1 items-center px-2 border-r border-gray-300 h-6",children:[e.jsx("button",{onClick:()=>Ve("bold"),className:`p-1 rounded ${p.bold?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-200"}`,children:e.jsx(Ze,{size:16})}),e.jsx("button",{onClick:()=>Ve("italic"),className:`p-1 rounded italic ${p.italic?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-200"}`,children:e.jsx(et,{size:16})}),e.jsx("button",{onClick:()=>Ve("underline"),className:`p-1 rounded underline ${p.underline?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-200"}`,children:e.jsx(Ut,{size:16})}),e.jsx("button",{className:"p-1 text-gray-700 hover:bg-gray-200 rounded",children:e.jsx(sa,{size:16})}),e.jsx("button",{className:"p-1 text-gray-700 hover:bg-gray-200 rounded",children:e.jsx(aa,{size:16})})]}),e.jsxs("div",{className:"flex gap-1 items-center px-2 border-r border-gray-300 h-6",children:[e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Wt,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(Bt,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ne,{size:16})})]}),e.jsxs("div",{className:"flex gap-1 items-center px-2 h-6",children:[e.jsx("button",{onClick:()=>fe("left"),className:`p-1 rounded ${p.align==="left"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(ie,{size:16})}),e.jsx("button",{onClick:()=>fe("center"),className:`p-1 rounded ${p.align==="center"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>fe("right"),className:`p-1 rounded ${p.align==="right"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(st,{size:16})}),e.jsx("button",{onClick:()=>fe("justify"),className:`p-1 rounded ${p.align==="justify"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(Vt,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(la,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ra,{size:16})}),e.jsx("button",{onClick:()=>Dt("bullet"),className:`p-1 rounded ${p.list==="bullet"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(at,{size:16})}),e.jsx("button",{onClick:()=>Dt("ordered"),className:`p-1 rounded ${p.list==="ordered"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-200"}`,children:e.jsx(Kt,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(na,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(ia,{size:16})}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-200 rounded",children:e.jsx(oa,{size:16})})]}),e.jsxs("div",{className:"ml-auto relative mode-selector flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 hidden sm:flex items-center gap-2",children:[e.jsxs("span",{children:[Bs," words"]}),e.jsx("span",{className:"text-gray-300",children:"â€¢"}),e.jsxs("span",{children:[Gs," chars"]}),xs&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300",children:"â€¢"}),e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(we,{size:12})," Saved"]})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{disabled:pt,className:"flex items-center gap-1.5 px-3 py-1.5 bg-purple-100 text-purple-700 rounded-full text-xs font-bold hover:bg-purple-200 transition-colors disabled:opacity-50",children:[pt?e.jsx(Ye,{size:12,className:"animate-spin"}):e.jsx(v,{size:12}),"AI Assist"]}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-xl z-50 py-2 hidden group-hover:flex flex-col animate-fade-in origin-top-right",children:[e.jsxs("button",{onClick:()=>je("improve"),className:"px-4 py-2 text-sm text-left hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ht,{size:14,className:"text-purple-500"})," Improve writing"]}),e.jsxs("button",{onClick:()=>je("fix"),className:"px-4 py-2 text-sm text-left hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Gt,{size:14,className:"text-blue-500"})," Fix grammar"]}),e.jsxs("button",{onClick:()=>je("summarize"),className:"px-4 py-2 text-sm text-left hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(ie,{size:14,className:"text-green-500"})," Summarize"]}),e.jsxs("button",{onClick:()=>je("expand"),className:"px-4 py-2 text-sm text-left hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(L,{size:14,className:"text-orange-500"})," Expand content"]})]})]}),e.jsxs("button",{onClick:()=>X(!de),className:"flex items-center bg-[#c2e7ff] rounded-full px-3 py-1 cursor-pointer hover:shadow-sm transition-all",children:[V==="Editing"&&e.jsx(_e,{size:14,className:"text-[#001d35] mr-2"}),V==="Suggesting"&&e.jsx(qt,{size:14,className:"text-[#001d35] mr-2"}),V==="Viewing"&&e.jsx(Qe,{size:14,className:"text-[#001d35] mr-2"}),e.jsx("span",{className:"text-xs font-bold text-[#001d35] min-w-[60px] text-left",children:V}),e.jsx(z,{size:12,className:"ml-2 text-[#001d35]"})]}),de&&e.jsxs("div",{className:"absolute top-full right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-xl z-50 py-1 flex flex-col animate-fade-in text-gray-800 origin-top-right",children:[e.jsxs("button",{onClick:()=>{Me("Editing"),X(!1)},className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-100 text-sm",children:[e.jsx(_e,{size:16,className:"text-gray-500 shrink-0"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-semibold",children:"Editing"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"Edit document directly"})]})]}),e.jsxs("button",{onClick:()=>{Me("Suggesting"),X(!1)},className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-100 text-sm",children:[e.jsx(qt,{size:16,className:"text-gray-500 shrink-0"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-semibold",children:"Suggesting"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"Propose changes"})]})]}),e.jsxs("button",{onClick:()=>{Me("Viewing"),X(!1)},className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-100 text-sm",children:[e.jsx(Qe,{size:16,className:"text-gray-500 shrink-0"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-semibold",children:"Viewing"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"Read or print"})]})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[u==="slides"&&e.jsx("div",{className:"flex w-full h-full bg-[#faf8f5]",children:rs?e.jsx("div",{className:"absolute inset-0 bg-[#faf8f5] z-50 flex flex-col items-center justify-center p-8 animate-fade-in overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("button",{onClick:()=>E(!1),className:"absolute top-6 left-6 flex items-center gap-2 text-slate-500 hover:text-slate-800 font-semibold text-sm transition-colors",children:[e.jsx(oe,{size:16})," Back to Editor"]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full border border-purple-200 mb-4",children:[e.jsx(v,{size:14,className:"text-purple-600"}),e.jsx("span",{className:"text-xs font-bold text-purple-700 uppercase tracking-wider",children:"AI-Powered"})]}),e.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Generate Slides with AI"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Describe your presentation and let AI create stunning slides for you."})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Your Prompt"}),e.jsx("textarea",{value:H,onChange:t=>he(t.target.value),placeholder:"e.g., 'Q4 strategy deck for fintech startup focusing on growth metrics, user acquisition, and 2025 roadmap...'",className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-4 text-sm text-slate-800 placeholder-slate-400 resize-none h-28 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Slide Count"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:dt,onChange:t=>ns(Number(t.target.value)),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-800 appearance-none font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:6,children:"6 slides"}),e.jsx("option",{value:8,children:"8 slides"}),e.jsx("option",{value:10,children:"10 slides"}),e.jsx("option",{value:12,children:"12 slides"}),e.jsx("option",{value:15,children:"15 slides"})]}),e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none",size:16})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Text Density"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"minimal",label:"Min",icon:e.jsx(ke,{size:14})},{id:"standard",label:"Std",icon:e.jsx(ie,{size:14})},{id:"detailed",label:"Max",icon:e.jsx(at,{size:14})}].map(t=>e.jsxs("button",{onClick:()=>os(t.id),className:`flex flex-col items-center justify-center p-2 rounded-lg border transition-all ${is===t.id?"border-purple-500 bg-purple-100 text-purple-700":"border-slate-200 text-slate-500 hover:text-slate-800 hover:border-slate-300"}`,children:[t.icon,e.jsx("span",{className:"text-[9px] font-bold uppercase mt-1",children:t.label})]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Language"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-800 appearance-none font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Spanish"}),e.jsx("option",{children:"French"}),e.jsx("option",{children:"German"}),e.jsx("option",{children:"Portuguese"})]}),e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none",size:16})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3 block flex items-center gap-2",children:[e.jsx(Qt,{size:12})," Theme"]}),e.jsx("div",{className:"grid grid-cols-10 gap-2",children:Object.entries(B).slice(0,10).map(([t,s])=>e.jsxs("button",{onClick:()=>xe(t),className:`relative h-12 rounded-lg overflow-hidden border-2 transition-all ${K===t?"border-purple-500 ring-2 ring-purple-500/30":"border-transparent hover:scale-105"}`,children:[e.jsx("div",{className:`absolute inset-0 ${s.bg}`}),K===t&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(we,{size:14,className:"text-white drop-shadow-lg"})})]},t))})]}),e.jsxs("button",{onClick:Us,disabled:!H.trim()||Ie,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white text-base font-bold py-4 rounded-xl shadow-lg shadow-purple-500/25 transition-all hover:shadow-purple-500/40 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:[Ie?e.jsx(Ye,{size:18,className:"animate-spin"}):e.jsx(v,{size:18,fill:"currentColor"}),Ie?"Generating...":"Generate Slides"]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3 text-center",children:"Try these prompts"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:["Startup pitch deck","Quarterly review","Product roadmap","Team introduction","Marketing strategy"].map(t=>e.jsx("button",{onClick:()=>he(t),className:"px-3 py-1.5 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-full text-xs text-slate-600 hover:text-slate-800 transition-all",children:t},t))})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:Re,style:{width:ht},className:"bg-white border-r border-slate-200 flex flex-col z-10 flex-shrink-0",children:[e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar",children:w.map((t,s)=>e.jsxs("div",{onClick:()=>P(s),className:`group relative aspect-video rounded-lg cursor-pointer transition-all duration-200 ${$===s?"ring-2 ring-purple-500 shadow-xl scale-[1.02] z-10":"hover:ring-2 hover:ring-white/20 opacity-70 hover:opacity-100"}`,children:[e.jsx("div",{className:"absolute top-1.5 left-1.5 px-1.5 py-0.5 rounded bg-black/60 text-white text-[9px] font-bold flex items-center justify-center backdrop-blur-sm z-20",children:s+1}),$===s&&e.jsx("button",{onClick:r=>{if(r.stopPropagation(),w.length>1){const a=w.filter((n,m)=>m!==s);U(a),P(Math.min(s,a.length-1))}},className:"absolute top-1.5 right-1.5 w-5 h-5 rounded bg-red-500/80 hover:bg-red-500 text-white flex items-center justify-center z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(I,{size:10})}),e.jsx("div",{className:"w-full h-full rounded-md overflow-hidden bg-white shadow-sm pointer-events-none transform origin-top-left",children:e.jsx("div",{style:{transform:"scale(0.2)",transformOrigin:"top left",width:"500%",height:"500%"},children:e.jsx(Pt,{slide:t,theme:K,editable:!1})})})]},t.id))}),e.jsxs("div",{className:"p-3 border-t border-slate-200 bg-white space-y-2",children:[e.jsxs("button",{onClick:Os,className:"w-full py-2.5 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-sm flex items-center justify-center gap-2 transition-all active:scale-95 border border-slate-200",children:[e.jsx(L,{size:14})," Add Slide"]}),e.jsxs("button",{onClick:()=>E(!0),className:"w-full py-2.5 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all shadow-lg shadow-purple-500/20 active:scale-95",children:[e.jsx(v,{size:14})," Generate with AI"]})]})]}),e.jsx("div",{onMouseDown:$t,className:`w-1 cursor-col-resize hover:bg-purple-500/50 transition-colors z-20 flex-shrink-0 hidden lg:block ${Z?"bg-purple-500":"bg-transparent"}`}),e.jsxs("div",{className:"flex-1 bg-[#faf8f5] flex flex-col relative overflow-hidden",children:[e.jsxs("div",{className:"h-14 border-b border-slate-200 bg-white flex items-center justify-between px-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-800 font-medium transition-all",children:[e.jsx(ca,{size:14}),"Layout",e.jsx(z,{size:12,className:"text-slate-500"})]}),e.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 rounded-xl shadow-2xl z-50 py-2 hidden group-hover:block animate-fade-in",children:Ca.map(t=>{var s,r;return e.jsxs("button",{onClick:()=>j("layout",t.id),className:`w-full text-left px-4 py-2.5 text-sm flex items-center gap-3 transition-colors ${((s=w[$])==null?void 0:s.layout)===t.id?"bg-purple-100 text-purple-700":"text-slate-700 hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-lg",children:t.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-[10px] text-slate-500",children:t.description})]}),((r=w[$])==null?void 0:r.layout)===t.id&&e.jsx(we,{size:14,className:"ml-auto text-purple-600"})]},t.id)})})]}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-800 font-medium transition-all",children:[e.jsx(Qt,{size:14}),"Theme",e.jsx(z,{size:12,className:"text-slate-500"})]}),e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-80 bg-white border border-slate-200 rounded-xl shadow-2xl z-50 p-4 hidden group-hover:block animate-fade-in",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Light Themes"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 mb-3",children:Object.entries(B).filter(([t,s])=>s.category==="light").map(([t,s])=>e.jsx("button",{onClick:()=>xe(t),className:`h-10 rounded-lg overflow-hidden border-2 transition-all ${K===t?"border-purple-500 ring-2 ring-purple-500/20":"border-transparent hover:scale-105"}`,children:e.jsx("div",{className:`w-full h-full ${s.bg}`})},t))}),e.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Dark Themes"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Object.entries(B).filter(([t,s])=>s.category==="dark").map(([t,s])=>e.jsx("button",{onClick:()=>xe(t),className:`h-10 rounded-lg overflow-hidden border-2 transition-all ${K===t?"border-purple-500 ring-2 ring-purple-500/20":"border-transparent hover:scale-105"}`,children:e.jsx("div",{className:`w-full h-full ${s.bg}`})},t))})]})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{className:"p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(ne,{size:16})}),e.jsx("button",{className:"p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Zt,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[$+1," / ",w.length]}),e.jsx("button",{onClick:()=>ct(!me),className:"p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(da,{size:16})}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-1.5 bg-purple-600 hover:bg-purple-500 text-white rounded-lg text-sm font-semibold transition-all",children:[e.jsx(xa,{size:14,fill:"currentColor"})," Present"]})]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center p-8 relative overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 1px 1px, #94a3b8 1px, transparent 0)",backgroundSize:"24px 24px"}}),e.jsxs("div",{className:`aspect-video bg-white shadow-2xl rounded-xl relative overflow-hidden flex flex-col transition-all duration-300 ring-1 ring-slate-200 ${me?"fixed inset-0 z-50 rounded-none":"w-full max-w-5xl"}`,children:[me&&e.jsx("button",{onClick:()=>ct(!1),className:"absolute top-4 right-4 z-50 p-2 bg-black/50 hover:bg-black/70 text-white rounded-lg transition-colors",children:e.jsx(I,{size:20})}),w[$]&&e.jsx(Pt,{slide:w[$],theme:K,editable:!me})]})]})]})]})}),u==="sheets"&&e.jsxs("div",{className:"flex h-full w-full bg-[#faf8f5]",children:[e.jsxs("div",{className:"w-64 border-r border-slate-200 bg-white flex flex-col shrink-0",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx(_t,{size:16,className:"text-emerald-500"}),"Sheets"]}),e.jsxs("div",{className:"space-y-1",children:[Ue.map(t=>e.jsxs("button",{onClick:()=>ft(t.id),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${fs===t.id?"bg-emerald-100 text-emerald-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-800"}`,children:[e.jsx(re,{size:14}),t.name]},t.id)),e.jsxs("button",{onClick:()=>{const t={id:Date.now().toString(),name:`Sheet ${Ue.length+1}`};gs([...Ue,t]),ft(t.id)},className:"w-full text-left px-3 py-2 rounded-lg text-sm font-medium text-slate-500 hover:bg-slate-50 hover:text-slate-800 transition-all flex items-center gap-2",children:[e.jsx(L,{size:14})," Add Sheet"]})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("button",{onClick:()=>bs(!Ge),className:"w-full flex items-center justify-between text-sm text-slate-600 hover:text-slate-800 transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Yt,{size:14})," Formulas"]}),e.jsx(z,{size:14,className:`transition-transform ${Ge?"rotate-180":""}`})]}),Ge&&e.jsx("div",{className:"mt-3 space-y-1",children:za.map(t=>e.jsxs("button",{onClick:()=>{d&&Ke(d.r,d.c,t.syntax)},className:"w-full text-left p-2 rounded-lg bg-slate-50 hover:bg-slate-100 transition-colors group",children:[e.jsx("div",{className:"text-xs font-mono text-emerald-600",children:t.name}),e.jsx("div",{className:"text-[10px] text-slate-500 group-hover:text-slate-600",children:t.description})]},t.name))})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Quick Charts"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{type:"bar",icon:"ðŸ“Š"},{type:"line",icon:"ðŸ“ˆ"},{type:"pie",icon:"ðŸ¥§"},{type:"none",icon:"âœ•"}].map(t=>e.jsx("button",{onClick:()=>jt(t.type),className:`aspect-square rounded-lg flex items-center justify-center text-lg transition-all ${te===t.type?"bg-emerald-100 ring-2 ring-emerald-500":"bg-slate-50 hover:bg-slate-100"}`,children:t.icon},t.type))})]}),e.jsx("div",{className:"p-4 mt-auto",children:e.jsxs("button",{className:"w-full py-2.5 rounded-xl bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all shadow-lg shadow-emerald-500/20",children:[e.jsx(v,{size:14})," AI Data Insights"]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 px-4 py-2 flex items-center gap-2 shrink-0",children:[e.jsxs("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:[e.jsx("button",{className:"p-1.5 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded transition-colors",children:e.jsx(Je,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded transition-colors",children:e.jsx(Xe,{size:15})})]}),e.jsx("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:e.jsxs("button",{className:"flex items-center gap-1 text-xs text-slate-700 bg-slate-50 hover:bg-slate-100 px-2.5 py-1.5 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-mono",children:"100%"})," ",e.jsx(z,{size:12})]})}),e.jsxs("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:[e.jsxs("button",{className:"flex items-center gap-1 text-xs text-slate-700 bg-slate-50 hover:bg-slate-100 px-2.5 py-1.5 rounded-lg w-24 justify-between transition-colors",children:["Arial ",e.jsx(z,{size:12})]}),e.jsxs("div",{className:"flex items-center gap-0.5 bg-slate-50 rounded-lg px-1",children:[e.jsx("button",{className:"text-slate-500 hover:text-slate-800 p-1",children:e.jsx(ke,{size:12})}),e.jsx("span",{className:"text-xs text-slate-800 w-6 text-center font-mono",children:"10"}),e.jsx("button",{className:"text-slate-500 hover:text-slate-800 p-1",children:e.jsx(L,{size:12})})]})]}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:()=>ae("fontWeight","bold"),className:`p-1.5 rounded transition-colors ${((Et=Ae[`${d==null?void 0:d.r}-${d==null?void 0:d.c}`])==null?void 0:Et.fontWeight)==="bold"?"bg-emerald-100 text-emerald-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(Ze,{size:15})}),e.jsx("button",{onClick:()=>ae("fontStyle","italic"),className:`p-1.5 rounded transition-colors ${((Mt=Ae[`${d==null?void 0:d.r}-${d==null?void 0:d.c}`])==null?void 0:Mt.fontStyle)==="italic"?"bg-emerald-100 text-emerald-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(et,{size:15})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{onClick:()=>ae("textAlign","left"),className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(ie,{size:15})}),e.jsx("button",{onClick:()=>ae("textAlign","center"),className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(tt,{size:15})}),e.jsx("button",{onClick:()=>ae("textAlign","right"),className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(st,{size:15})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(ma,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(ha,{size:15})})]}),e.jsx("div",{className:"ml-auto flex items-center gap-2",children:e.jsx("span",{className:"text-xs text-slate-500",children:d?`${lt(d.c)}${d.r+1}`:"Select a cell"})})]}),e.jsxs("div",{className:"flex items-center px-4 py-2 border-b border-slate-200 bg-white gap-3",children:[e.jsx("div",{className:"flex items-center gap-2 text-slate-500 min-w-[60px]",children:e.jsx("span",{className:"text-xs font-mono font-bold text-emerald-600 bg-emerald-100 px-2 py-1 rounded",children:d?`${lt(d.c)}${d.r+1}`:"â€”"})}),e.jsx("div",{className:"h-6 w-px bg-slate-200"}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Yt,{size:14,className:"text-slate-500"}),e.jsx("input",{className:"flex-1 bg-transparent border-none outline-none text-sm text-slate-800 font-mono placeholder-slate-400",placeholder:"Enter formula or value...",value:d?G[d.r][d.c]:"",onChange:t=>d&&Ke(d.r,d.c,t.target.value),disabled:!d})]})]}),te!=="none"&&e.jsx("div",{className:"h-48 border-b border-slate-200 bg-slate-50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 flex items-center justify-center gap-4 border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-4xl",children:te==="bar"?"ðŸ“Š":te==="line"?"ðŸ“ˆ":"ðŸ¥§"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Chart Preview"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Select data range to generate ",te," chart"]})]}),e.jsx("button",{onClick:()=>jt("none"),className:"p-1 text-slate-500 hover:text-slate-800",children:e.jsx(I,{size:14})})]})}),e.jsx("div",{className:"flex-1 overflow-auto relative custom-scrollbar bg-slate-50",children:e.jsxs("div",{className:"inline-block relative",children:[e.jsxs("div",{className:"flex sticky top-0 z-20",children:[e.jsx("div",{className:"w-12 h-8 bg-slate-100 border-r border-b border-slate-200 sticky left-0 z-30"}),Array.from({length:ce}).map((t,s)=>e.jsx("div",{className:"w-32 h-8 bg-slate-100 border-r border-b border-slate-200 flex items-center justify-center text-xs font-bold text-slate-500 select-none uppercase",children:lt(s)},s))]}),G.map((t,s)=>e.jsxs("div",{className:"flex group",children:[e.jsx("div",{className:"w-12 h-8 bg-slate-100 border-r border-b border-slate-200 flex items-center justify-center text-xs font-bold text-slate-500 select-none sticky left-0 z-10 group-hover:bg-slate-200 transition-colors",children:s+1}),t.map((r,a)=>{const n=(d==null?void 0:d.r)===s&&(d==null?void 0:d.c)===a;return e.jsxs("div",{onClick:()=>ze({r:s,c:a}),className:`w-32 h-8 border-r border-b border-slate-200 relative transition-colors ${n?"z-10 ring-2 ring-emerald-500 bg-emerald-100":"bg-white hover:bg-slate-50"}`,children:[e.jsx("input",{className:"w-full h-full bg-transparent border-none outline-none px-2 text-xs text-slate-700 font-mono",style:Ae[`${s}-${a}`]||{},value:r,onChange:m=>Ke(s,a,m.target.value)}),n&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-emerald-500 cursor-crosshair rounded-sm"})]},a)})]},s))]})})]})]}),u==="docs"&&e.jsxs("div",{className:`flex flex-1 w-full ${M?"bg-slate-100":"bg-[#faf8f5]"} relative`,children:[!M&&e.jsxs("div",{ref:Re,style:{width:ht},className:"border-r border-slate-200 bg-white flex flex-col shrink-0 hidden lg:flex",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx(T,{size:16,className:"text-blue-500"}),"Document"]}),ee>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[b.split(/\s+/).filter(Boolean).length," / ",ee," words"]})]}),e.jsx("div",{className:"h-1.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all",style:{width:`${Math.min(b.split(/\s+/).filter(Boolean).length/ee*100,100)}%`}})})]}),e.jsxs("button",{onClick:()=>us(ee>0?0:500),className:"text-xs text-slate-500 hover:text-slate-800 transition-colors flex items-center gap-1",children:[e.jsx(ua,{size:12})," ",ee>0?"Clear goal":"Set writing goal"]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Sections"}),e.jsx("button",{onClick:Fs,className:"text-slate-500 hover:text-slate-800 transition-colors",children:e.jsx(L,{size:14})})]}),e.jsx("div",{className:"space-y-1",children:Pe.map(t=>e.jsxs("button",{onClick:()=>ot(t.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg font-medium text-sm transition-colors ${as===t.id?"bg-blue-100 text-blue-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-800"}`,children:[e.jsx(T,{size:14}),t.title]},t.id))})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200 flex-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Outline"}),e.jsx("div",{className:"space-y-1 text-sm",children:gt.length>0?gt.map((t,s)=>e.jsxs("div",{className:"text-slate-600 hover:text-slate-800 cursor-pointer transition-colors flex items-center gap-2",style:{paddingLeft:(t.level-1)*12},children:[e.jsx("div",{className:"w-1 h-1 bg-slate-400 rounded-full"}),t.text]},s)):e.jsx("p",{className:"text-xs text-slate-400 italic",children:"Headings will appear here"})})]}),e.jsxs("div",{className:"p-4 border-t border-slate-200",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-slate-500",children:"Words"}),e.jsx("div",{className:"text-slate-800 font-mono",children:b.split(/\s+/).filter(Boolean).length})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-slate-500",children:"Chars"}),e.jsx("div",{className:"text-slate-800 font-mono",children:b.length})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-slate-500",children:"Lines"}),e.jsx("div",{className:"text-slate-800 font-mono",children:b.split(`
`).length})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-slate-500",children:"Read time"}),e.jsxs("div",{className:"text-slate-800 font-mono",children:[Math.ceil(b.split(/\s+/).filter(Boolean).length/200)," min"]})]})]})]})]}),!M&&e.jsx("div",{onMouseDown:$t,className:`w-1 cursor-col-resize hover:bg-blue-500/50 transition-colors z-20 shrink-0 hidden lg:block ${Z?"bg-blue-500":"bg-transparent"}`}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[!M&&e.jsxs("div",{className:"bg-white border-b border-slate-200 px-4 py-2 flex items-center gap-2 shrink-0",children:[e.jsxs("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:[e.jsx("button",{className:"p-1.5 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded transition-colors",children:e.jsx(Je,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded transition-colors",children:e.jsx(Xe,{size:15})})]}),e.jsx("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:e.jsxs("button",{className:"flex items-center gap-1 text-xs text-slate-700 bg-slate-50 hover:bg-slate-100 px-2.5 py-1.5 rounded-lg w-28 justify-between transition-colors",children:[["Normal text","Heading 1","Heading 2","Heading 3"][0]," ",e.jsx(z,{size:12})]})}),e.jsxs("div",{className:"flex gap-1 border-r border-slate-200 pr-3 mr-2",children:[e.jsxs("button",{className:"flex items-center gap-1 text-xs text-slate-700 bg-slate-50 hover:bg-slate-100 px-2.5 py-1.5 rounded-lg w-24 justify-between transition-colors",children:["Arial ",e.jsx(z,{size:12})]}),e.jsxs("div",{className:"flex items-center gap-0.5 bg-slate-50 rounded-lg px-1",children:[e.jsx("button",{onClick:()=>f(Math.max(8,o-1)),className:"text-slate-500 hover:text-slate-800 p-1",children:e.jsx(ke,{size:12})}),e.jsx("span",{className:"text-xs text-slate-800 w-6 text-center font-mono",children:o}),e.jsx("button",{onClick:()=>f(Math.min(72,o+1)),className:"text-slate-500 hover:text-slate-800 p-1",children:e.jsx(L,{size:12})})]})]}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:()=>y(t=>({...t,bold:!t.bold})),className:`p-1.5 rounded transition-colors ${p.bold?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(Ze,{size:15})}),e.jsx("button",{onClick:()=>y(t=>({...t,italic:!t.italic})),className:`p-1.5 rounded transition-colors ${p.italic?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(et,{size:15})}),e.jsx("button",{onClick:()=>y(t=>({...t,underline:!t.underline})),className:`p-1.5 rounded transition-colors ${p.underline?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(Ut,{size:15})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{onClick:()=>y(t=>({...t,align:"left"})),className:`p-1.5 rounded transition-colors ${p.align==="left"?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(ie,{size:15})}),e.jsx("button",{onClick:()=>y(t=>({...t,align:"center"})),className:`p-1.5 rounded transition-colors ${p.align==="center"?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(tt,{size:15})}),e.jsx("button",{onClick:()=>y(t=>({...t,align:"right"})),className:`p-1.5 rounded transition-colors ${p.align==="right"?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(st,{size:15})}),e.jsx("button",{onClick:()=>y(t=>({...t,align:"justify"})),className:`p-1.5 rounded transition-colors ${p.align==="justify"?"bg-blue-100 text-blue-600":"text-slate-500 hover:bg-slate-100 hover:text-slate-800"}`,children:e.jsx(Vt,{size:15})}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1"}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(at,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(Kt,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(pa,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(ba,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(Wt,{size:15})}),e.jsx("button",{className:"p-1.5 text-slate-500 hover:bg-slate-100 hover:text-slate-800 rounded transition-colors",children:e.jsx(ne,{size:15})})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>Oe(!0),className:"flex items-center gap-1.5 text-xs text-slate-500 hover:text-slate-800 px-2.5 py-1.5 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx(Rt,{size:14})," Focus"]}),e.jsxs("button",{onClick:()=>hs(!Be),className:`flex items-center gap-1.5 text-xs px-2.5 py-1.5 rounded-lg transition-colors ${Be?"bg-purple-100 text-purple-600":"text-slate-500 hover:text-slate-800 hover:bg-slate-50"}`,children:[e.jsx(v,{size:14})," AI Assist"]})]})]}),M&&e.jsxs("button",{onClick:()=>Oe(!1),className:"absolute top-4 right-4 z-50 flex items-center gap-1.5 text-xs text-slate-500 hover:text-slate-800 px-3 py-1.5 rounded-lg bg-slate-50 hover:bg-slate-100 transition-all",children:[e.jsx(I,{size:14})," Exit Focus"]}),e.jsx("div",{className:`flex-1 overflow-y-auto flex justify-center p-8 ${M?"py-16":""}`,children:e.jsx("div",{className:`bg-white shadow-xl rounded-xl border border-slate-200 relative transition-all ${M?"w-[700px] min-h-[800px] p-16":"w-[816px] min-h-[1056px] p-16"}`,children:e.jsx("textarea",{autoFocus:!0,readOnly:V==="Viewing",className:"w-full min-h-[800px] resize-none border-none outline-none font-sans leading-relaxed text-slate-800 bg-transparent focus:outline-none focus:ring-0 cursor-text placeholder-slate-400",style:{fontFamily:"Georgia, serif",fontSize:`${o}pt`,fontWeight:p.bold?"bold":"normal",fontStyle:p.italic?"italic":"normal",textDecoration:p.underline?"underline":"none",textAlign:p.align,caretColor:"#3b82f6",lineHeight:"1.8"},value:b,onChange:t=>c(t.target.value),spellCheck:!1,placeholder:V==="Viewing"?"":"Start writing your masterpiece..."})})})]}),Be&&!M&&e.jsxs("div",{className:"w-72 border-l border-slate-200 bg-white flex flex-col shrink-0",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(v,{size:16,className:"text-purple-500"}),"AI Writing Assistant"]})}),e.jsxs("div",{className:"p-4 space-y-2 flex-1",children:[e.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Quick Actions"}),[{label:"Write introduction",icon:Ht,prompt:"intro"},{label:"Expand paragraph",icon:ga,prompt:"expand"},{label:"Summarize text",icon:T,prompt:"summarize"},{label:"Improve writing",icon:fa,prompt:"improve"},{label:"Fix grammar",icon:Jt,prompt:"grammar"},{label:"Make it formal",icon:ja,prompt:"formal"},{label:"Make it casual",icon:va,prompt:"casual"},{label:"Continue writing",icon:Na,prompt:"continue"}].map(t=>e.jsxs("button",{className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg bg-slate-50 hover:bg-slate-100 text-slate-700 hover:text-slate-900 text-sm transition-all group",children:[e.jsx(t.icon,{size:14,className:"text-purple-500 group-hover:text-purple-600"}),t.label]},t.prompt))]}),e.jsx("div",{className:"p-4 border-t border-slate-200",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-2.5 text-sm text-slate-800 placeholder-slate-400 focus:outline-none focus:border-purple-500/50",placeholder:"Custom prompt..."}),e.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 bg-purple-500 hover:bg-purple-400 rounded-lg text-white transition-colors",children:e.jsx(ya,{size:14})})]})})]})]})]}),Ns&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-sm",onClick:()=>be(!1)}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-80 bg-white shadow-2xl animate-slide-in-right flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(qe,{size:16,className:"text-blue-500"}),"Version History"]}),e.jsx("button",{onClick:()=>be(!1),className:"p-1.5 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(I,{size:16,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[{id:"v5",time:"Just now",user:"You",changes:"Added AI features and premium UI",isCurrent:!0},{id:"v4",time:"10 minutes ago",user:"You",changes:"Updated slide templates",isCurrent:!1},{id:"v3",time:"1 hour ago",user:"You",changes:"Created presentation outline",isCurrent:!1},{id:"v2",time:"2 hours ago",user:"You",changes:"Initial content draft",isCurrent:!1},{id:"v1",time:"3 hours ago",user:"You",changes:"Document created",isCurrent:!1}].map(t=>e.jsxs("div",{className:`p-3 rounded-xl border transition-all cursor-pointer ${t.isCurrent?"border-blue-200 bg-blue-50":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.isCurrent?"bg-blue-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-xs font-semibold text-slate-800",children:t.time})]}),t.isCurrent&&e.jsx("span",{className:"text-[9px] font-bold uppercase px-2 py-0.5 bg-blue-500 text-white rounded-full",children:"Current"})]}),e.jsx("p",{className:"text-xs text-slate-600 pl-4",children:t.changes}),e.jsxs("p",{className:"text-[10px] text-slate-400 pl-4 mt-1",children:["by ",t.user]}),!t.isCurrent&&e.jsxs("div",{className:"flex gap-2 mt-2 pl-4",children:[e.jsx("button",{className:"text-[10px] font-semibold text-blue-600 hover:text-blue-800",children:"Preview"}),e.jsx("button",{className:"text-[10px] font-semibold text-slate-600 hover:text-slate-800",children:"Restore"})]})]},t.id))}),e.jsx("div",{className:"p-4 border-t border-slate-200 bg-slate-50",children:e.jsx("p",{className:"text-[10px] text-slate-500 text-center",children:"Version history is auto-saved every 5 minutes"})})]})]}),e.jsx("div",{className:"fixed bottom-6 right-6 z-[200] space-y-2 pointer-events-none",children:kt.map(t=>e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl shadow-xl pointer-events-auto animate-slide-up ${t.type==="success"?"bg-emerald-500 text-white":t.type==="warning"?"bg-amber-500 text-white":"bg-slate-800 text-white"}`,children:[t.type==="success"&&e.jsx(Jt,{size:16}),t.type==="warning"&&e.jsx(wa,{size:16}),t.type==="info"&&e.jsx(ka,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:t.message}),e.jsx("button",{onClick:()=>O(kt.filter(s=>s.id!==t.id)),className:"p-1 hover:bg-white/20 rounded transition-colors",children:e.jsx(I,{size:14})})]},t.id))})]})};export{_a as DocumentEditorPane,_a as default};
