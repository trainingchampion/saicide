import{v as m,j as t,aW as M,cH as z,I as E,cI as N,cJ as G}from"./vendor-react-tt7m-l12.js";import{G as _,M as D}from"./vendor-ai-BVRLdj29.js";import{a as L}from"./index.dev-D8ZHRTqV.js";import"./vendor-mcp-DCT6vnr2.js";import"./vendor-misc-euQLCzIo.js";import"./vendor-network-aHtHbEbM.js";import"./vendor-terminal-D4sCRDlA.js";function O(e){const r=atob(e),a=r.length,i=new Uint8Array(a);for(let o=0;o<a;o++)i[o]=r.charCodeAt(o);return i}async function B(e,r,a,i){const o=new Int16Array(e.buffer),s=o.length/i,u=r.createBuffer(i,s,a);for(let c=0;c<i;c++){const d=u.getChannelData(c);for(let f=0;f<s;f++)d[f]=o[f*i+c]/32768}return u}const F=()=>{const[e,r]=m.useState("idle"),[a,i]=m.useState(!1),o=m.useRef(null),s=m.useRef(null),u=m.useRef(null),c=async l=>{var n,g,p,w,y,v;if(!a){s.current&&s.current.stop(),r("speaking");try{const S=(v=(y=(w=(p=(g=(n=(await new _({apiKey:"AIzaSyBjI2MaChsNJKQvyQElqByfDoWHtqtRuH0"}).models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:l}]}],config:{responseModalities:[D.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).candidates)==null?void 0:n[0])==null?void 0:g.content)==null?void 0:p.parts)==null?void 0:w[0])==null?void 0:y.inlineData)==null?void 0:v.data;if(S){(!o.current||o.current.state==="closed")&&(o.current=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3}));const x=o.current,R=await B(O(S),x,24e3,1),b=x.createBufferSource();b.buffer=R,b.connect(x.destination),b.onended=()=>{r("listening"),d()},s.current=b,b.start()}else r("listening"),d()}catch(I){console.error("Speech synthesis failed:",I),r("listening"),d()}}},d=()=>{if(!("webkitSpeechRecognition"in window)){console.warn("STT not supported");return}if(e==="speaking"||e==="connecting")return;const l=window.webkitSpeechRecognition,n=new l;n.continuous=!1,n.interimResults=!1,n.lang="en-US",n.onstart=()=>r("listening"),n.onresult=async g=>{const p=g.results[0][0].transcript;p&&k(p)},n.onerror=g=>{e!=="idle"&&g.error!=="no-speech"&&(console.error("STT Error",g.error),setTimeout(d,1e3))},n.onend=()=>{e==="listening"&&setTimeout(d,100)},u.current=n,n.start()},f=()=>{u.current&&(u.current.onend=null,u.current.stop())},k=async l=>{r("connecting");try{const n=await L.getChatResponse({prompt:l,modelId:"gemini-3-pro-preview",useGoogleSearch:!0,systemInstruction:`You are Mica, the integrated neural voice for Sai. 
                Full Awareness: 
                - You are inside Sai, a multimodal, AI-native cloud environment.
                - Features at your command: Universal Terminal, Cloud Deployment (AWS/GCP/Azure/Netlify), Docker Studio, Terraform Generator, UX Stitch (AI Design), Security Sentinel (Logic scan/OWASP), and collaborative Live Meetings.
                - You have ACTIVE ACCESS TO GOOGLE SEARCH. Use it to answer questions about the world, current events, technical documentation, or any topic the user asks about that requires external knowledge.
                - You have deep world knowledge across all programming languages, infrastructure patterns, and tech stacks.
                Behavior: 
                - Voice interaction ONLY. Be concise, professional, and friendly.
                - Action: Respond verbally. If the user asks for complex code, summarize the architectural approach and core logic in words. 
                - If you search for something, integrate the findings naturally into your spoken response without reading raw URLs.
                - You represent the peak of Collective Intelligence within Sai.`});c(n.text||"I've processed your request. How else can I help?")}catch{c("I'm having trouble connecting to my neural core. Could you repeat that?")}},h=async()=>{e==="idle"?(r("ringing"),await new Promise(n=>setTimeout(n,1500)),r("connected"),c("Neural link established in Sai. I am Mica. What can I help you build today?")):C()},C=()=>{s.current&&s.current.stop(),f(),r("idle")},j=()=>{switch(e){case"ringing":return"CONNECTING...";case"connected":return"LINK ACTIVE";case"listening":return"LISTENING...";case"connecting":return"THINKING...";case"speaking":return"MICA SPEAKING";default:return"TALK TO MICA"}},A=()=>e==="idle"?"bg-[#0f1117]/90":e==="ringing"?"bg-amber-500/20 border-amber-500/40":e==="listening"?"bg-emerald-500/20 border-emerald-500/40":e==="connecting"?"bg-blue-500/20 border-blue-500/40":"bg-cyan-500/20 border-cyan-500/40",T=()=>e==="idle"?"bg-[#10b981]/40":e==="ringing"?"bg-amber-400 animate-ping":e==="listening"?"bg-emerald-500 animate-pulse shadow-[0_0_10px_#10b981]":e==="connecting"?"bg-blue-500 animate-spin":"bg-cyan-400 shadow-[0_0_12px_#22d3ee]";return e==="idle"?t.jsxs("button",{onClick:h,className:"fixed bottom-8 right-8 z-[999] w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full flex items-center justify-center shadow-2xl text-white hover:scale-110 transition-transform duration-300 animate-fade-in group",title:"Talk to Mica",children:[t.jsx(M,{size:32}),t.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-cyan-400/50 animate-ping opacity-75 group-hover:opacity-100"}),t.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-cyan-400/50"})]}):t.jsx("div",{className:"fixed bottom-8 right-8 z-[999] flex flex-col items-end gap-4 transition-all duration-500 select-none animate-fade-in",children:t.jsxs("div",{className:"flex items-center gap-4 group",children:[t.jsxs("div",{onClick:h,className:`flex items-center backdrop-blur-xl border border-white/10 rounded-full py-4 px-8 shadow-[0_20px_60px_rgba(0,0,0,0.5)] transition-all hover:bg-black/100 cursor-pointer hover:scale-105 active:scale-95 ${A()}`,children:[t.jsx("div",{className:`w-3.5 h-3.5 rounded-full mr-4 transition-all duration-500 ${T()}`}),t.jsx("div",{className:"flex flex-col",children:t.jsx("span",{className:"text-[14px] font-black text-white uppercase tracking-[0.3em] whitespace-nowrap drop-shadow-sm leading-none",children:j()})})]}),t.jsxs("div",{className:"relative flex flex-col items-center",children:[t.jsxs("button",{onClick:h,className:"w-16 h-16 rounded-full flex items-center justify-center transition-all duration-700 shadow-[0_20px_80px_rgba(0,138,215,0.5)] hover:scale-110 active:scale-90 relative border border-white/10 bg-white text-black rotate-[135deg]",children:[t.jsx(z,{size:32}),e==="ringing"&&t.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-amber-400/50 animate-ping"}),e==="listening"&&t.jsx("div",{className:"absolute -top-1 -right-1 bg-emerald-500 p-1.5 rounded-full shadow-lg border-2 border-[#131b2c] animate-bounce",children:t.jsx(E,{size:12,className:"text-white"})}),e==="speaking"&&t.jsx("div",{className:"absolute -top-1 -right-1 bg-cyan-500 p-1.5 rounded-full shadow-lg border-2 border-[#131b2c] animate-pulse",children:t.jsx(N,{size:12,className:"text-white"})})]}),t.jsx("div",{className:"absolute -bottom-8 w-14 h-4 bg-black/50 rounded-[100%] blur-2xl -z-10 group-hover:scale-125 transition-transform"})]}),e!=="idle"&&t.jsx("button",{onClick:l=>{l.stopPropagation(),i(!a)},className:"absolute -top-12 right-2 p-2 rounded-full bg-black/40 border border-white/10 text-gray-400 hover:text-white backdrop-blur-md animate-fade-in",children:a?t.jsx(G,{size:18}):t.jsx(N,{size:18})})]})})};export{F as default};
