import{v as d,j as e,ah as F}from"./vendor-react-tt7m-l12.js";import{b as B,c as G,S as m,I as V}from"./index.dev-DC3GzjrE.js";import"./vendor-mcp-DCT6vnr2.js";import"./vendor-misc-euQLCzIo.js";import"./vendor-network-aHtHbEbM.js";import"./vendor-terminal-D4sCRDlA.js";import"./vendor-ai-BVRLdj29.js";const K=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[var(--color-text-accent)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.072-.267-2.09-.75-3.042z"})}),b=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[var(--color-warning)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),j=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[var(--color-success)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),q=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Y=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),p=({icon:a,label:x,value:u})=>e.jsxs("div",{className:"bg-[var(--color-background-secondary)] border border-[var(--color-border)] shadow-[0_0_20px_var(--color-card-glow)] rounded-lg p-4 flex items-center space-x-4",children:[a,e.jsxs("div",{children:[e.jsx("p",{className:"text-[var(--color-text-secondary)] text-sm",children:x}),e.jsx("p",{className:"text-xl font-bold text-white",children:u})]})]}),_=({level:a})=>{const x={critical:"bg-red-500/20 text-red-400",high:"bg-orange-500/20 text-orange-400",medium:"bg-yellow-500/20 text-yellow-400",low:"bg-gray-500/20 text-gray-400"}[a];return e.jsx("span",{className:`uppercase text-xs font-bold px-2 py-0.5 rounded-full ${x}`,children:a})},Q=({standard:a,description:x,status:u})=>e.jsxs("div",{className:"flex items-start justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:a}),e.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-0.5",children:x})]}),u==="pass"?e.jsx(j,{}):e.jsx(b,{})]}),Z=({control:a})=>e.jsxs("div",{className:"flex items-start gap-3 py-3 border-b border-[var(--color-border)] last:border-0 group",children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0 text-green-400",children:a.status==="pass"?e.jsx(j,{}):e.jsx(b,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white text-sm group-hover:text-[var(--color-text-accent)] transition-colors",children:a.control}),e.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-1 leading-relaxed",children:a.description})]})]}),J=({policy:a,onToggle:x})=>e.jsx("div",{className:"bg-[var(--color-background-secondary)] border border-[var(--color-border)] shadow-[0_0_20px_var(--color-card-glow)] rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-bold text-white",children:a.title}),e.jsx(_,{level:a.severity})]}),e.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mt-1",children:a.description}),a.violationsCount>0&&e.jsxs("div",{className:"text-[var(--color-warning)] text-sm mt-2 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("span",{className:"ml-2",children:[a.violationsCount," violations detected"]})]})]}),e.jsx("div",{onClick:()=>x(a.id),className:`w-12 h-6 rounded-full p-1 flex items-center cursor-pointer transition-colors ${a.enabled?"bg-[var(--color-accent)]":"bg-[var(--color-background-hover)]"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full transform transition-transform ${a.enabled?"translate-x-6":"translate-x-0"}`})})]})}),ne=({securityIssues:a,onCollapse:x,policies:u,onTogglePolicy:T,onSetPolicies:w,fileStructure:h})=>{const[A,R]=d.useState(B),[y,k]=d.useState(!1),[v,C]=d.useState("overview"),[f,N]=d.useState([]),[S,L]=d.useState([]),[P,M]=d.useState(0),[H,D]=d.useState(0),[U,I]=d.useState("100.0%"),z=d.useMemo(()=>{let s=0;const i=r=>{if(r.type==="file"){const t=r.content||"",c=t.match(/resource\s+"[^"]+"\s+"[^"]+"/g);if(c&&(s+=c.length),r.name.toLowerCase()==="dockerfile"){const l=t.split(`
`).filter(o=>o.trim().match(/^(FROM|RUN|COPY|ADD|CMD|ENTRYPOINT)/)).length;s+=l}const n=t.match(/kind:\s*(Deployment|Service|Pod|Ingress|ConfigMap|Secret|StatefulSet)/g);n&&(s+=n.length)}r.children&&r.children.forEach(i)};return i(h),s},[h]),$=d.useMemo(()=>{const s=[],i=r=>{if(r.type==="file"&&r.content){const t=r.content,c=r.name.toLowerCase();c.includes(".tf")&&(/aws_flow_log|google_compute_subnetwork.*log_config|azurerm_network_watcher_flow_log/i.test(t)&&s.push({id:"vpc-flow",control:"VPC Flow Logs Enabled",description:`Found in ${r.name}`,status:"pass"}),/encrypted\s*=\s*true|storage_encrypted\s*=\s*true|kms_key/i.test(t)&&s.push({id:"encrypt",control:"Encryption Enabled",description:`Storage encryption configured in ${r.name}`,status:"pass"}),/multi_az\s*=\s*true|availability_zone/i.test(t)&&s.push({id:"multi-az",control:"Multi-AZ Deployment",description:`High availability configured in ${r.name}`,status:"pass"}),/versioning\s*\{[\s\S]*enabled\s*=\s*true/i.test(t)&&s.push({id:"s3-version",control:"S3 Bucket Versioning",description:`Versioning enabled in ${r.name}`,status:"pass"}),/block_public_acls\s*=\s*true/i.test(t)&&s.push({id:"s3-public",control:"S3 Public Access Blocked",description:`Public access blocked in ${r.name}`,status:"pass"})),c==="dockerfile"&&(/^USER\s+(?!root)/im.test(t)&&s.push({id:"docker-user",control:"Non-Root Container User",description:"Container runs as non-root user",status:"pass"}),/HEALTHCHECK/i.test(t)&&s.push({id:"docker-health",control:"Docker Health Check",description:"Container has health check configured",status:"pass"})),(c.includes(".yaml")||c.includes(".yml"))&&(/securityContext[\s\S]*runAsNonRoot:\s*true/i.test(t)&&s.push({id:"k8s-nonroot",control:"K8s Non-Root Pod",description:"Pod configured to run as non-root",status:"pass"}),/resources:[\s\S]*limits:/i.test(t)&&s.push({id:"k8s-limits",control:"K8s Resource Limits",description:"Resource limits configured for pods",status:"pass"}),/networkPolicy/i.test(t)&&s.push({id:"k8s-netpol",control:"K8s Network Policy",description:"Network policies configured",status:"pass"}))}r.children&&r.children.forEach(i)};return i(h),s.length>0?s:G},[h]);d.useEffect(()=>{const s=u.filter(t=>t.enabled),i=s.reduce((t,c)=>t+c.violationsCount,0),r=s.filter(t=>t.violationsCount>0).length;if(M(s.length),D(i),s.length===0)I("100.0%");else{const t=(s.length-r)/s.length*100;I(`${t.toFixed(1)}%`)}},[u]);const g=d.useCallback((s,i,r)=>{if(s.type==="file"&&s.content){const t=s.content.split(`
`),c=s.name.toLowerCase();t.forEach((n,l)=>{const o=l+1,E=n.toLowerCase();if((/password\s*[=:]\s*['"]\w+/i.test(n)||/api[_-]?key\s*[=:]\s*['"]\w+/i.test(n)||/secret\s*[=:]\s*['"]\w+/i.test(n)||/token\s*[=:]\s*['"]\w+/i.test(n))&&(i.push({id:`${s.name}-${o}-cred`,file:s.name,line:o,severity:m.CRITICAL,description:"Hardcoded credential detected",recommendation:"Use environment variables or a secrets manager"}),r.push(`ðŸ”´ CRITICAL: Hardcoded credential in ${s.name}:${o}`)),(/acl\s*=\s*["']public-read/i.test(n)||/acl\s*=\s*["']public-read-write/i.test(n)||/public_access_block\s*=\s*false/i.test(n))&&(i.push({id:`${s.name}-${o}-s3`,file:s.name,line:o,severity:m.CRITICAL,description:"Public S3 bucket access detected",recommendation:"Set ACL to private and use proper IAM policies"}),r.push(`ðŸ”´ CRITICAL: Public S3 access in ${s.name}:${o}`)),/0\.0\.0\.0\/0/.test(n)&&(/22|ssh/i.test(n)||E.includes("from_port")||E.includes("ingress"))&&(i.push({id:`${s.name}-${o}-ssh`,file:s.name,line:o,severity:m.MEDIUM,description:"SSH port open to world (0.0.0.0/0)",recommendation:"Restrict SSH access to specific IP ranges"}),r.push(`ðŸŸ¡ MEDIUM: Open SSH access in ${s.name}:${o}`)),(c.includes(".tf")||c.includes("terraform"))&&(/encrypted\s*=\s*false/i.test(n)||/storage_encrypted\s*=\s*false/i.test(n))&&(i.push({id:`${s.name}-${o}-encrypt`,file:s.name,line:o,severity:m.HIGH,description:"Unencrypted storage resource",recommendation:"Enable encryption for data at rest"}),r.push(`ðŸŸ  HIGH: Unencrypted storage in ${s.name}:${o}`)),c.includes(".tf")&&/resource\s+"aws_/i.test(n)){const W=t.slice(l,l+20).join(`
`);/tags\s*=/.test(W)||(i.push({id:`${s.name}-${o}-tags`,file:s.name,line:o,severity:m.LOW,description:"AWS resource may be missing required tags",recommendation:"Add CostCenter and Environment tags"}),r.push(`âšª LOW: Missing tags in ${s.name}:${o}`))}c==="dockerfile"&&/^USER\s+root/i.test(n.trim())&&(i.push({id:`${s.name}-${o}-root`,file:s.name,line:o,severity:m.HIGH,description:"Container running as root user",recommendation:"Use a non-root user for better security"}),r.push(`ðŸŸ  HIGH: Root user in Dockerfile:${o}`)),/\beval\s*\(/.test(n)&&(i.push({id:`${s.name}-${o}-eval`,file:s.name,line:o,severity:m.HIGH,description:"Use of eval() detected - code injection risk",recommendation:"Avoid eval() - use safer alternatives"}),r.push(`ðŸŸ  HIGH: eval() usage in ${s.name}:${o}`)),(/\+\s*["'].*SELECT|INSERT|UPDATE|DELETE/i.test(n)||/\$\{.*\}.*SELECT|INSERT|UPDATE|DELETE/i.test(n))&&(i.push({id:`${s.name}-${o}-sql`,file:s.name,line:o,severity:m.CRITICAL,description:"Potential SQL injection vulnerability",recommendation:"Use parameterized queries or an ORM"}),r.push(`ðŸ”´ CRITICAL: SQL injection risk in ${s.name}:${o}`))})}s.children&&s.children.forEach(t=>g(t,i,r))},[]),O=d.useCallback(()=>{k(!0),L(["ðŸ” Starting security scan..."]),N([]),setTimeout(()=>{const s=[],i=["ðŸ” Starting security scan..."];g(h,s,i),i.push(`
ðŸ“Š Scan complete: ${s.length} issue(s) found`),N(s),L(i),w(r=>r.map(t=>{let c=0;return t.enabled&&(c=s.filter(l=>t.issueTypes.includes(l.severity)).length),{...t,violationsCount:c}})),R(r=>r.map(t=>{const c=s.filter(l=>l.severity===m.CRITICAL).length,n=s.filter(l=>l.severity===m.HIGH).length;return t.id==="soc2"&&(c>0||n>2)?{...t,status:"fail"}:t.id==="pci"&&c>0?{...t,status:"fail"}:t.id==="hipaa"&&s.some(l=>l.description.includes("credential"))?{...t,status:"fail"}:{...t,status:"pass"}})),k(!1)},800)},[h,w,g]);return e.jsxs("div",{className:"p-4 h-full flex flex-col overflow-y-auto bg-[var(--color-background)] text-[var(--color-text-primary)]",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:x,title:"Collapse Panel",className:"text-[var(--color-text-secondary)] hover:text-white p-1 rounded-md hover:bg-[var(--color-background-tertiary)]",children:V.COLLAPSE_LEFT})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("span",{className:"inline-block bg-[var(--color-background-tertiary)]/50 border border-[var(--color-border)] rounded-full px-3 py-1 text-sm text-[var(--color-text-primary)]",children:"Governance & Compliance"}),e.jsx("h1",{className:"text-2xl font-bold text-white mt-3",children:"Built-in Policy Enforcement"}),e.jsx("p",{className:"text-[var(--color-text-secondary)] mt-2",children:"Automated governance with compliance checks and security guardrails"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsx(p,{icon:e.jsx(K,{}),label:"Active Policies",value:P}),e.jsx(p,{icon:e.jsx(b,{}),label:"Policy Violations",value:H}),e.jsx(p,{icon:e.jsx(j,{}),label:"Compliance Score",value:U}),e.jsx(p,{icon:e.jsx(q,{}),label:"Resources Monitored",value:z})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Security Policies"}),e.jsx("button",{onClick:O,disabled:y,className:"bg-[var(--color-accent)] hover:bg-[var(--color-accent-hover)] text-white font-semibold py-2 px-4 rounded-lg text-sm flex items-center disabled:bg-gray-600 disabled:cursor-wait",children:y?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:16,className:"animate-spin mr-2"}),"Scanning Workspace..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),"Scan Project"]})})]}),u.map(s=>e.jsx(J,{policy:s,onToggle:T},s.id)),f.length>0&&e.jsxs("div",{className:"mt-6 bg-[var(--color-background-secondary)] border border-[var(--color-border)] shadow-[0_0_20px_var(--color-card-glow)] rounded-lg p-4",children:[e.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Detected Issues (",f.length,")"]}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto custom-scrollbar",children:f.map(s=>e.jsx("div",{className:"bg-[var(--color-background-tertiary)] border border-[var(--color-border)] rounded-lg p-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_,{level:s.severity===m.CRITICAL?"critical":s.severity===m.HIGH?"high":s.severity===m.MEDIUM?"medium":"low"}),e.jsxs("span",{className:"text-xs text-[var(--color-text-secondary)]",children:[s.file,":",s.line]})]}),e.jsx("p",{className:"text-sm text-white font-medium",children:s.description}),e.jsxs("p",{className:"text-xs text-[var(--color-text-secondary)] mt-1",children:["ðŸ’¡ ",s.recommendation]})]})})},s.id))})]}),S.length>1&&e.jsxs("div",{className:"mt-4 bg-[var(--color-background-tertiary)] border border-[var(--color-border)] rounded-lg p-3",children:[e.jsx("h5",{className:"text-sm font-semibold text-[var(--color-text-secondary)] mb-2",children:"Scan Log"}),e.jsx("div",{className:"font-mono text-xs space-y-1 max-h-[150px] overflow-y-auto custom-scrollbar",children:S.map((s,i)=>e.jsx("div",{className:"text-[var(--color-text-secondary)]",children:s},i))})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-bold text-white",children:"Compliance Status"})}),e.jsxs("div",{className:"bg-[var(--color-background-secondary)] border border-[var(--color-border)] shadow-[0_0_20px_var(--color-card-glow)] rounded-lg flex flex-col h-[500px]",children:[e.jsxs("div",{className:"flex border-b border-[var(--color-border)]",children:[e.jsx("button",{onClick:()=>C("overview"),className:`flex-1 py-3 text-sm font-semibold transition-colors ${v==="overview"?"text-[var(--color-accent)] border-b-2 border-[var(--color-accent)] bg-[var(--color-background-tertiary)]/30":"text-gray-400 hover:text-white"}`,children:"Overview"}),e.jsx("button",{onClick:()=>C("infrastructure"),className:`flex-1 py-3 text-sm font-semibold transition-colors ${v==="infrastructure"?"text-[var(--color-accent)] border-b-2 border-[var(--color-accent)] bg-[var(--color-background-tertiary)]/30":"text-gray-400 hover:text-white"}`,children:"Infrastructure Security"})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 custom-scrollbar",children:v==="overview"?e.jsx("div",{className:"divide-y divide-[var(--color-border)]",children:A.map(s=>e.jsx(Q,{standard:s.standard,description:s.description,status:s.status},s.id))}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3 uppercase font-bold tracking-wider",children:$.length>0?"Detected Security Controls":"Default Controls"}),$.map(s=>e.jsx(Z,{control:s},s.id))]})})]})]})]})]})};export{ne as default};
