import{v as t,j as e,X as k,au as f,aq as C,bW as z}from"./vendor-react-tt7m-l12.js";import{a as b}from"./index.dev-D8ZHRTqV.js";import"./vendor-mcp-DCT6vnr2.js";import"./vendor-misc-euQLCzIo.js";import"./vendor-network-aHtHbEbM.js";import"./vendor-terminal-D4sCRDlA.js";import"./vendor-ai-BVRLdj29.js";const L=({isOpen:n,onClose:o,filePath:h,lineNumber:p,thread:a,onAddComment:g,onSynthesizeTask:y,currentUser:S})=>{const[r,d]=t.useState(""),[x,l]=t.useState(!1),[m,i]=t.useState(null),j=t.useRef(null),c=t.useRef(null);if(t.useEffect(()=>{n&&(i(null),setTimeout(()=>{var s;return(s=c.current)==null?void 0:s.scrollIntoView({behavior:"smooth"})},100))},[n]),t.useEffect(()=>{var s;(s=c.current)==null||s.scrollIntoView({behavior:"smooth"})},[a]),!n)return null;const u=()=>{r.trim()&&(g(r.trim()),d(""))},v=async()=>{l(!0),i("Jules is thinking...");try{const s=await b.summarizeCommentThread(a);i(s)}catch{i("Failed to generate summary.")}finally{l(!1)}},N=async()=>{l(!0);try{const s=await b.synthesizeTaskFromText(a.map(w=>w.text).join(`
`));s&&(y(s),o())}catch(s){console.error("Task synthesis failed",s)}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center animate-fade-in",onClick:o,children:e.jsxs("div",{ref:j,className:"bg-[#1e2227] w-full max-w-lg rounded-2xl border border-gray-700 shadow-2xl flex flex-col max-h-[70vh]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white",children:"Discussion Thread"}),e.jsxs("p",{className:"text-xs text-gray-400 font-mono truncate",children:[h,":",p]})]}),e.jsx("button",{onClick:o,className:"p-1 rounded-full text-gray-400 hover:text-white hover:bg-white/10",children:e.jsx(k,{size:18})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[a.map(s=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-xs font-bold text-white flex-shrink-0",children:s.initials}),e.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg flex-1",children:[e.jsxs("div",{className:"flex items-baseline justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-300",children:s.author}),e.jsx("span",{className:"text-[10px] text-gray-500",children:s.timestamp})]}),e.jsx("p",{className:"text-sm text-gray-200",children:s.text})]})]},s.id)),e.jsx("div",{ref:c})]}),m&&e.jsxs("div",{className:"p-4 border-t border-b border-gray-700 bg-black/20",children:[e.jsxs("h4",{className:"text-xs font-bold text-purple-400 mb-2 flex items-center gap-2",children:[e.jsx(f,{size:14})," AI Summary"]}),e.jsx("p",{className:"text-xs text-gray-300 italic",children:m})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:v,disabled:x||a.length<2,className:"flex-1 flex items-center justify-center gap-2 text-xs font-bold bg-purple-500/10 text-purple-300 hover:bg-purple-500/20 py-2 rounded-md disabled:opacity-50 transition-colors",children:[e.jsx(f,{size:14})," Summarize"]}),e.jsxs("button",{onClick:N,disabled:x||a.length===0,className:"flex-1 flex items-center justify-center gap-2 text-xs font-bold bg-blue-500/10 text-blue-300 hover:bg-blue-500/20 py-2 rounded-md disabled:opacity-50 transition-colors",children:[e.jsx(C,{size:14})," Create Task"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:s=>d(s.target.value),onKeyDown:s=>s.key==="Enter"&&u(),placeholder:"Add to the discussion...",className:"flex-1 bg-gray-900/50 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-blue-500"}),e.jsx("button",{onClick:u,className:"p-2 bg-blue-600 rounded-lg text-white hover:bg-blue-500 disabled:opacity-50",disabled:!r.trim(),children:e.jsx(z,{size:18})})]})]})]})})};export{L as default};
